<!DOCTYPE html>
<html lang="id" class="">
<!-- Kelas 'dark' akan ditambahkan oleh JS jika diperlukan -->

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Unanza - Dashboard ERP</title>
    <!-- Muat Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Muat Feather Icons -->
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
    <!-- Muat Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Font Inter -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }

        /* Styling Scrollbar kustom */
        ::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }

        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb {
            background: #c5c5c5;
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }

        /* Styling untuk dark mode scrollbar */
        .dark ::-webkit-scrollbar-track {
            background: #2d3748;
        }

        .dark ::-webkit-scrollbar-thumb {
            background: #4a5568;
        }

        .dark ::-webkit-scrollbar-thumb:hover {
            background: #718096;
        }

        /* Animasi submenu */
        .submenu {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
        }

        .submenu-open {
            max-height: 500px;
            /* Atur ke nilai yang cukup besar */
        }

        /* Gaya link sidebar aktif */
        .sidebar-link.active {
            background-color: #eef2ff;
            /* indigo-50 */
            color: #4f46e5;
            /* indigo-600 */
            font-weight: 600;
        }

        .dark .sidebar-link.active {
            background-color: #3730a3;
            /* indigo-800 */
            color: #eef2ff;
            /* indigo-50 */
        }

        /* Gaya menu drill-down aktif */
        .drill-down.active>a {
            color: #4f46e5;
            /* indigo-600 */
            font-weight: 600;
        }

        .dark .drill-down.active>a {
            color: #c7d2fe;
            /* indigo-200 */
        }

        /* Animasi modal */
        .modal-enter {
            animation: fadeIn 0.3s ease-out;
        }

        .modal-leave {
            animation: fadeOut 0.3s ease-in;
        }

        /* (BARU) Gaya Chat Bantuan */
        .chat-bubble {
            max-width: 80%;
            padding: 10px 16px;
            border-radius: 18px;
        }

        .chat-bubble.user {
            background-color: #4f46e5;
            /* indigo-600 */
            color: white;
            border-bottom-right-radius: 4px;
        }

        .chat-bubble.gemini {
            background-color: #e5e7eb;
            /* gray-200 */
            color: #1f2937;
            /* gray-800 */
            border-bottom-left-radius: 4px;
        }

        .dark .chat-bubble.gemini {
            background-color: #374151;
            /* gray-700 */
            color: #f3f4f6;
            /* gray-100 */
        }

        /* (BARU) Indikator Mengetik */
        .typing-indicator span {
            height: 8px;
            width: 8px;
            background-color: #9ca3af;
            border-radius: 50%;
            display: inline-block;
            animation: bounce 1.4s infinite;
        }

        .dark .typing-indicator span {
            background-color: #6b7280;
        }

        .typing-indicator span:nth-of-type(2) {
            animation-delay: 0.2s;
        }

        .typing-indicator span:nth-of-type(3) {
            animation-delay: 0.4s;
        }

        @keyframes bounce {

            0%,
            80%,
            100% {
                transform: scale(0);
            }

            40% {
                transform: scale(1);
            }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: scale(0.95);
            }

            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        @keyframes fadeOut {
            from {
                opacity: 1;
                transform: scale(1);
            }

            to {
                opacity: 0;
                transform: scale(0.95);
            }
        }
    </style>
    <script>
        // Konfigurasi Tailwind untuk Dark Mode
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                    animation: {
                        fadeIn: 'fadeIn 0.3s ease-out',
                    }
                },
            },
        }
    </script>
</head>

<body class="bg-gray-100 dark:bg-gray-900 text-gray-900 dark:text-gray-100 antialiased">

    <!-- Wrapper Utama Flex -->
    <div class="flex h-screen overflow-hidden">

        <!-- =================================================================== -->
        <!-- SIDEBAR (Menu Navigasi) -->
        <!-- =================================================================== -->
        <!-- FIX MOBILE: -translate-x-full untuk mobile, md:translate-x-0 untuk desktop -->
        <aside id="sidebar"
            class="fixed inset-y-0 left-0 w-64 bg-white dark:bg-gray-800 shadow-md flex-shrink-0 transition-transform duration-300 transform -translate-x-full md:relative md:translate-x-0 z-30 flex flex-col overflow-y-auto">
            <!-- Logo & Judul -->
            <div class="h-16 flex items-center justify-center px-4 border-b border-gray-200 dark:border-gray-700">
                <!-- (MODIFIKASI) Ditambahkan flex dan ikon SVG -->
                <a href="#dashboard" class="sidebar-link flex items-center space-x-2">
                    <!-- (BARU) Ikon Logo Unanza -->
                    <svg class="w-6 h-6" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <rect width="24" height="24" rx="6" fill="#4f46e5" />
                        <path d="M8 7v6a4 4 0 0 0 8 0V7" stroke="white" stroke-width="2.5" stroke-linecap="round"
                            stroke-linejoin="round" />
                    </svg>
                    <span class="text-2xl font-bold text-indigo-600 dark:text-indigo-400">Unanza</span>
                </a>
            </div>

            <!-- Konten Menu (Scrollable) -->
            <nav class="flex-1 py-4 px-3 space-y-1 overflow-y-auto">
                <!-- Grup Menu: Utama -->
                <div>
                    <h3 class="px-3 text-xs font-semibold text-gray-500 uppercase tracking-wider mb-1">Utama</h3>
                    <a href="#dashboard"
                        class="sidebar-link flex items-center px-3 py-2.5 rounded-lg transition-colors duration-150 hover:bg-gray-100 dark:hover:bg-gray-700">
                        <i data-feather="home" class="w-5 h-5 mr-3"></i>
                        <span>Dashboard</span>
                    </a>
                </div>

                <!-- Grup Menu: Keuangan (Drill-down) -->
                <div class="drill-down">
                    <a href="#"
                        class="sidebar-link flex items-center justify-between px-3 py-2.5 rounded-lg transition-colors duration-150 hover:bg-gray-100 dark:hover:bg-gray-700">
                        <span class="flex items-center">
                            <i data-feather="bar-chart-2" class="w-5 h-5 mr-3"></i>
                            <span>Laporan</span>
                        </span>
                        <i data-feather="chevron-right"
                            class="w-4 h-4 transition-transform duration-300"></i>
                    </a>
                    <div class="submenu pl-8 space-y-1 pt-1">
                        <a href="#laporan-labarugi"
                            class="sidebar-link flex items-center px-3 py-2 text-sm rounded-lg transition-colors duration-150 hover:bg-gray-100 dark:hover:bg-gray-700">Laba
                            Rugi</a>
                        <a href="#laporan-neraca"
                            class="sidebar-link flex items-center px-3 py-2 text-sm rounded-lg transition-colors duration-150 hover:bg-gray-100 dark:hover:bg-gray-700">Neraca</a>
                        <a href="#laporan-aruskas"
                            class="sidebar-link flex items-center px-3 py-2 text-sm rounded-lg transition-colors duration-150 hover:bg-gray-100 dark:hover:bg-gray-700">Arus
                            Kas</a>
                        <a href="#laporan-biaya"
                            class="sidebar-link flex items-center px-3 py-2 text-sm rounded-lg transition-colors duration-150 hover:bg-gray-100 dark:hover:bg-gray-700">Laporan
                            Biaya</a>
                    </div>
                </div>

                <!-- (MODIFIKASI) Grup Menu: Operasional -->
                <div>
                    <h3 class="px-3 mt-4 text-xs font-semibold text-gray-500 uppercase tracking-wider mb-1">
                        Operasional</h3>
                    <!-- (BARU) Menu Penjualan -->
                    <div class="drill-down">
                        <a href="#"
                            class="sidebar-link flex items-center justify-between px-3 py-2.5 rounded-lg transition-colors duration-150 hover:bg-gray-100 dark:hover:bg-gray-700">
                            <span class="flex items-center">
                                <i data-feather="trending-up" class="w-5 h-5 mr-3"></i>
                                <span>Penjualan</span>
                            </span>
                            <i data-feather="chevron-right"
                                class="w-4 h-4 transition-transform duration-300"></i>
                        </a>
                        <div class="submenu pl-8 space-y-1 pt-1">
                            <a href="#pesanan-penjualan"
                                class="sidebar-link flex items-center px-3 py-2 text-sm rounded-lg transition-colors duration-150 hover:bg-gray-100 dark:hover:bg-gray-700">Pesanan
                                Penjualan</a>
                            <a href="#faktur-penjualan"
                                class="sidebar-link flex items-center px-3 py-2 text-sm rounded-lg transition-colors duration-150 hover:bg-gray-100 dark:hover:bg-gray-700">Faktur
                                Penjualan</a>
                        </div>
                    </div>
                    <!-- (BARU) Menu Pembelian -->
                    <div class="drill-down">
                        <a href="#"
                            class="sidebar-link flex items-center justify-between px-3 py-2.5 rounded-lg transition-colors duration-150 hover:bg-gray-100 dark:hover:bg-gray-700">
                            <span class="flex items-center">
                                <i data-feather="shopping-cart" class="w-5 h-5 mr-3"></i>
                                <span>Pembelian</span>
                            </span>
                            <i data-feather="chevron-right"
                                class="w-4 h-4 transition-transform duration-300"></i>
                        </a>
                        <div class="submenu pl-8 space-y-1 pt-1">
                            <a href="#pesanan-pembelian"
                                class="sidebar-link flex items-center px-3 py-2 text-sm rounded-lg transition-colors duration-150 hover:bg-gray-100 dark:hover:bg-gray-700">Pesanan
                                Pembelian</a>
                            <a href="#faktur-pembelian"
                                class="sidebar-link flex items-center px-3 py-2 text-sm rounded-lg transition-colors duration-150 hover:bg-gray-100 dark:hover:bg-gray-700">Faktur
                                Pembelian</a>
                        </div>
                    </div>
                    <!-- Menu Buku Besar -->
                    <a href="#buku-besar"
                        class="sidebar-link flex items-center px-3 py-2.5 rounded-lg transition-colors duration-150 hover:bg-gray-100 dark:hover:bg-gray-700">
                        <i data-feather="book" class="w-5 h-5 mr-3"></i>
                        <span>Buku Besar</span>
                    </a>
                </div>

                <!-- Grup Menu: Master Data -->
                <div class="drill-down">
                    <a href="#"
                        class="sidebar-link flex items-center justify-between px-3 py-2.5 rounded-lg transition-colors duration-150 hover:bg-gray-100 dark:hover:bg-gray-700">
                        <span class="flex items-center">
                            <i data-feather="database" class="w-5 h-5 mr-3"></i>
                            <span>Master Data</span>
                        </span>
                        <i data-feather="chevron-right"
                            class="w-4 h-4 transition-transform duration-300"></i>
                    </a>
                    <div class="submenu pl-8 space-y-1 pt-1">
                        <a href="#data-pelanggan"
                            class="sidebar-link flex items-center px-3 py-2 text-sm rounded-lg transition-colors duration-150 hover:bg-gray-100 dark:hover:bg-gray-700">Data
                            Pelanggan</a>
                        <a href="#data-supplier"
                            class="sidebar-link flex items-center px-3 py-2 text-sm rounded-lg transition-colors duration-150 hover:bg-gray-100 dark:hover:bg-gray-700">Data
                            Supplier</a>
                        <a href="#data-coa"
                            class="sidebar-link flex items-center px-3 py-2 text-sm rounded-lg transition-colors duration-150 hover:bg-gray-100 dark:hover:bg-gray-700">Daftar
                            Akun (COA)</a>
                    </div>
                </div>

                <!-- Grup Menu: Lainnya -->
                <div class="drill-down">
                    <a href="#"
                        class="sidebar-link flex items-center justify-between px-3 py-2.5 rounded-lg transition-colors duration-150 hover:bg-gray-100 dark:hover:bg-gray-700">
                        <span class="flex items-center">
                            <i data-feather="more-horizontal" class="w-5 h-5 mr-3"></i>
                            <span>Lainnya</span>
                        </span>
                        <i data-feather="chevron-right"
                            class="w-4 h-4 transition-transform duration-300"></i>
                    </a>
                    <div class="submenu pl-8 space-y-1 pt-1">
                        <a href="#pengaturan"
                            class="sidebar-link flex items-center px-3 py-2 text-sm rounded-lg transition-colors duration-150 hover:bg-gray-100 dark:hover:bg-gray-700">Pengaturan</a>
                        <a href="#bantuan"
                            class="sidebar-link flex items-center px-3 py-2 text-sm rounded-lg transition-colors duration-150 hover:bg-gray-100 dark:hover:bg-gray-700">Bantuan</a>
                    </div>
                </div>

                <!-- Grup Menu: Portal Eksternal -->
                <div>
                    <h3 class="px-3 mt-4 text-xs font-semibold text-gray-500 uppercase tracking-wider mb-1">
                        Portal Eksternal</h3>
                    <a href="#" target="_blank" title="Buka Portal Pelanggan (di tab baru)"
                        class="sidebar-link flex items-center justify-between px-3 py-2.5 rounded-lg transition-colors duration-150 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700">
                        <span class="flex items-center">
                            <i data-feather="users" class="w-5 h-5 mr-3"></i>
                            <span>Portal Pelanggan</span>
                        </span>
                        <i data-feather="external-link" class="w-4 h-4"></i>
                    </a>
                    <a href="#" target="_blank" title="Buka Portal Vendor (di tab baru)"
                        class="sidebar-link flex items-center justify-between px-3 py-2.5 rounded-lg transition-colors duration-150 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700">
                        <span class="flex items-center">
                            <i data-feather="briefcase" class="w-5 h-5 mr-3"></i>
                            <span>Portal Vendor</span>
                        </span>
                        <i data-feather="external-link" class="w-4 h-4"></i>
                    </a>
                </div>
            </nav>

            <!-- (BARU) Dropdown Profil -->
            <div id="profile-dropdown"
                class="absolute bottom-20 left-4 right-4 z-40 bg-white dark:bg-gray-700 rounded-lg shadow-lg overflow-hidden hidden p-2 border border-gray-200 dark:border-gray-600 animate-fadeIn">
                <a href="#pengaturan"
                    class="sidebar-link flex items-center px-3 py-2 text-sm rounded-md transition-colors duration-150 hover:bg-gray-100 dark:hover:bg-gray-600">
                    <i data-feather="user" class="w-4 h-4 mr-2"></i>
                    <span>Edit Profil</span>
                </a>
                <a href="#" id="btn-logout"
                    class="flex items-center px-3 py-2 text-sm rounded-md transition-colors duration-150 text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900">
                    <i data-feather="log-out" class="w-4 h-4 mr-2"></i>
                    <span>Keluar</span>
                </a>
            </div>

            <!-- Profil Pengguna (di bawah) -->
            <!-- (MODIFIKASI) Ditambahkan id="profile-button" dan class cursor-pointer -->
            <div id="profile-button"
                class="p-4 border-t border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700 cursor-pointer transition-colors">
                <div class="flex items-center pointer-events-none"> <!-- pointer-events-none agar klik tembus ke div induk -->
                    <img class="h-10 w-10 rounded-full object-cover"
                        src="https://placehold.co/100x100/e2e8f0/64748b?text=AP" alt="User avatar">
                    <div class="ml-3">
                        <p class="text-sm font-medium">Andi Permana</p>
                        <p class="text-xs text-gray-500 dark:text-gray-400">admin@unanza.com</p>
                    </div>
                </div>
            </div>
        </aside>

        <!-- =================================================================== -->
        <!-- KONTEN UTAMA -->
        <!-- =================================================================== -->
        <div class="flex-1 flex flex-col overflow-hidden">
            <!-- Header Atas -->
            <header
                class="h-16 bg-white dark:bg-gray-800 shadow-sm flex items-center justify-between px-4 sm:px-6 lg:px-8 z-10">
                <!-- Kiri: Tombol Menu Mobile & Judul Halaman -->
                <div class="flex items-center">
                    <!-- Tombol Menu Mobile (hanya tampil di < md) -->
                    <button id="mobile-menu-button"
                        class="md:hidden mr-3 text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white">
                        <i data-feather="menu" class="w-6 h-6"></i>
                    </button>

                    <!-- Judul Halaman & Breadcrumbs -->
                    <div>
                        <h1 id="page-title" class="text-xl font-semibold">Dashboard</h1>
                        <p id="breadcrumbs" class="text-xs text-gray-500 dark:text-gray-400">Utama /
                            Dashboard</p>
                    </div>
                </div>

                <!-- Kanan: Search & Notifikasi -->
                <div class="flex items-center space-x-4">
                    <!-- Search Bar -->
                    <!-- (MODIFIKASI) Ditambahkan relative & id -->
                    <div class="relative hidden sm:block">
                        <input type="text" id="header-search-input"
                            class="pl-10 pr-4 py-2 w-64 rounded-lg border border-gray-300 dark:border-gray-700 bg-gray-50 dark:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500"
                            placeholder="Cari transaksi...">
                        <div
                            class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                            <i data-feather="search" class="w-5 h-5 text-gray-400"></i>
                        </div>

                        <!-- (BARU) Dropdown Hasil Pencarian -->
                        <div id="search-results-dropdown"
                            class="absolute top-full mt-2 w-64 bg-white dark:bg-gray-700 rounded-lg shadow-lg overflow-hidden hidden z-40 border border-gray-200 dark:border-gray-600">
                            <ul id="search-results-list" class="divide-y divide-gray-100 dark:divide-gray-600">
                                <!-- Hasil dummy akan disisipkan oleh JS -->
                                <li class="p-3 text-sm text-gray-500 dark:text-gray-400 text-center">Mulai mengetik
                                    untuk mencari...</li>
                            </ul>
                        </div>
                    </div>

                    <!-- Tombol Notifikasi -->
                    <!-- (MODIFIKASI) Ditambahkan id="notification-button" & relative -->
                    <div class="relative">
                        <button id="notification-button"
                            class="p-2 rounded-full text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-gray-900 dark:hover:text-white">
                            <i data-feather="bell" class="w-5 h-5"></i>
                        </button>

                        <!-- (BARU) Dropdown Notifikasi -->
                        <div id="notification-dropdown"
                            class="absolute top-full right-0 mt-2 w-80 bg-white dark:bg-gray-700 rounded-lg shadow-lg overflow-hidden hidden z-40 border border-gray-200 dark:border-gray-600 animate-fadeIn">
                            <div class="p-3 font-medium border-b border-gray-200 dark:border-gray-600">Notifikasi</div>
                            <ul class="divide-y divide-gray-100 dark:divide-gray-600 max-h-64 overflow-y-auto">
                                <li class="p-3 hover:bg-gray-50 dark:hover:bg-gray-600">
                                    <p class="text-sm font-medium">Faktur #INV-2024-002 Lunas</p>
                                    <p class="text-xs text-gray-500 dark:text-gray-400">PT Jaya Abadi melakukan
                                        pembayaran.</p>
                                </li>
                                <li class="p-3 hover:bg-gray-50 dark:hover:bg-gray-600">
                                    <p class="text-sm font-medium">Laporan Laba Rugi Siap</p>
                                    <p class="text-xs text-gray-500 dark:text-gray-400">Laporan Keuangan Q3 telah
                                        dibuat.</p>
                                </li>
                                <li class="p-3 hover:bg-gray-50 dark:hover:bg-gray-600">
                                    <p class="text-sm font-medium text-red-600 dark:text-red-400">Faktur
                                        #INV-2024-003 Jatuh Tempo</p>
                                    <p class="text-xs text-gray-500 dark:text-gray-400">CV Sinar Terang terlambat 12
                                        hari.</p>
                                </li>
                            </ul>
                            <div class="p-2 text-center border-t border-gray-200 dark:border-gray-600">
                                <a href="#"
                                    class="text-sm font-medium text-indigo-600 dark:text-indigo-400 hover:underline">Lihat
                                    Semua</a>
                            </div>
                        </div>
                    </div>
                </div>
            </header>

            <!-- Area Konten (Scrollable) -->
            <main id="mainContent" class="flex-1 overflow-x-hidden overflow-y-auto p-4 sm:p-6 lg:p-8">
                <!-- Konten akan dimuat di sini oleh JS -->
            </main>
        </div>
    </div>


    <!-- =================================================================== -->
    <!-- TEMPLATE KONTEN HALAMAN -->
    <!-- =================================================================== -->
    <template id="dashboard-content-template">
        <div class="space-y-6">
            <!-- Header Ringkasan -->
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-5">
                <!-- Kartu Ringkasan 1 -->
                <div
                    class="bg-white dark:bg-gray-800 p-5 rounded-xl shadow-md flex items-center justify-between">
                    <div>
                        <p class="text-sm font-medium text-gray-500 dark:text-gray-400">Total Pemasukan
                        </p>
                        <p class="text-2xl font-bold">Rp 1.55 M</p>
                        <p class="text-xs text-green-500 flex items-center">
                            <i data-feather="arrow-up" class="w-4 h-4"></i>
                            <span>15% vs bulan lalu</span>
                        </p>
                    </div>
                    <div
                        class="w-12 h-12 rounded-full bg-green-100 dark:bg-green-900 flex items-center justify-center">
                        <i data-feather="trending-up" class="w-6 h-6 text-green-600 dark:text-green-300"></i>
                    </div>
                </div>
                <!-- Kartu Ringkasan 2 -->
                <div
                    class="bg-white dark:bg-gray-800 p-5 rounded-xl shadow-md flex items-center justify-between">
                    <div>
                        <p class="text-sm font-medium text-gray-500 dark:text-gray-400">Total Biaya</p>
                        <p class="text-2xl font-bold">Rp 820 Jt</p>
                        <p class="text-xs text-red-500 flex items-center">
                            <i data-feather="arrow-down" class="w-4 h-4"></i>
                            <span>5% vs bulan lalu</span>
                        </p>
                    </div>
                    <div
                        class="w-12 h-12 rounded-full bg-red-100 dark:bg-red-900 flex items-center justify-center">
                        <i data-feather="trending-down"
                            class="w-6 h-6 text-red-600 dark:text-red-300"></i>
                    </div>
                </div>
                <!-- Kartu Ringkasan 3 -->
                <div
                    class="bg-white dark:bg-gray-800 p-5 rounded-xl shadow-md flex items-center justify-between">
                    <div>
                        <p class="text-sm font-medium text-gray-500 dark:text-gray-400">Laba Bersih</p>
                        <p class="text-2xl font-bold">Rp 450 Jt</p>
                        <p class="text-xs text-green-500 flex items-center">
                            <i data-feather="arrow-up" class="w-4 h-4"></i>
                            <span>20% vs bulan lalu</span>
                        </p>
                    </div>
                    <div
                        class="w-12 h-12 rounded-full bg-indigo-100 dark:bg-indigo-900 flex items-center justify-center">
                        <i data-feather="target"
                            class="w-6 h-6 text-indigo-600 dark:text-indigo-300"></i>
                    </div>
                </div>
                <!-- Kartu Ringkasan 4 -->
                <div
                    class="bg-white dark:bg-gray-800 p-5 rounded-xl shadow-md flex items-center justify-between">
                    <div>
                        <p class="text-sm font-medium text-gray-500 dark:text-gray-400">Saldo Kas</p>
                        <p class="text-2xl font-bold">Rp 400 Jt</p>
                        <p class="text-xs text-gray-500 flex items-center">
                            <i data-feather="check-circle" class="w-4 h-4"></i>
                            <span>Per hari ini</span>
                        </p>
                    </div>
                    <div
                        class="w-12 h-12 rounded-full bg-blue-100 dark:bg-blue-900 flex items-center justify-center">
                        <i data-feather="dollar-sign"
                            class="w-6 h-6 text-blue-600 dark:text-blue-300"></i>
                    </div>
                </div>
            </div>

            <!-- Grafik & Akses Cepat -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <!-- Grafik Utama (Lebih besar) -->
                <div class="lg:col-span-2 bg-white dark:bg-gray-800 p-6 rounded-xl shadow-md">
                    <h3 class="text-lg font-semibold mb-4">Ringkasan Arus Kas (6 Bulan)</h3>
                    <div class="h-80">
                        <canvas id="financialChart"></canvas>
                    </div>
                </div>

                <!-- Akses Cepat (Lebih kecil) -->
                <div class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-md">
                    <h3 class="text-lg font-semibold mb-4">Akses Cepat</h3>
                    <div class="space-y-4">
                        <button id="dash-buat-faktur"
                            class="w-full flex items-center p-4 rounded-lg bg-indigo-50 dark:bg-indigo-900 hover:bg-indigo-100 dark:hover:bg-indigo-800 transition-colors">
                            <div
                                class="w-10 h-10 rounded-lg bg-indigo-100 dark:bg-indigo-800 flex items-center justify-center mr-4">
                                <i data-feather="file-plus"
                                    class="w-5 h-5 text-indigo-600 dark:text-indigo-300"></i>
                            </div>
                            <!-- FIX: Warna teks disamakan -->
                            <span class="font-medium text-indigo-700 dark:text-indigo-200">Buat Faktur
                                Penjualan</span>
                        </button>
                        <button id="dash-biaya-baru"
                            class="w-full flex items-center p-4 rounded-lg bg-red-50 dark:bg-red-900 hover:bg-red-100 dark:hover:bg-red-800 transition-colors">
                            <div
                                class="w-10 h-10 rounded-lg bg-red-100 dark:bg-red-800 flex items-center justify-center mr-4">
                                <i data-feather="trending-down"
                                    class="w-5 h-5 text-red-600 dark:text-red-300"></i>
                            </div>
                            <!-- FIX: Warna teks disamakan -->
                            <span class="font-medium text-red-700 dark:text-red-200">Catat Biaya
                                Baru</span>
                        </button>
                        <button id="dash-data-pelanggan"
                            class="w-full flex items-center p-4 rounded-lg bg-green-50 dark:bg-green-900 hover:bg-green-100 dark:hover:bg-green-800 transition-colors">
                            <div
                                class="w-10 h-10 rounded-lg bg-green-100 dark:bg-green-800 flex items-center justify-center mr-4">
                                <i data-feather="users"
                                    class="w-5 h-5 text-green-600 dark:text-green-300"></i>
                            </div>
                            <!-- FIX: Warna teks disamakan -->
                            <span class="font-medium text-green-700 dark:text-green-200">Data
                                Pelanggan</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Tabel Transaksi Terkini -->
            <div class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-md">
                <h3 class="text-lg font-semibold mb-4">Aktivitas Terbaru</h3>
                <div class="overflow-x-auto">
                    <table class="w-full min-w-max">
                        <thead>
                            <tr
                                class="border-b border-gray-200 dark:border-gray-700 text-left text-xs text-gray-500 dark:text-gray-400 uppercase">
                                <th class="py-3 px-4">Deskripsi</th>
                                <th class="py-3 px-4">Tanggal</th>
                                <th class="py-3 px-4">Tipe</th>
                                <th class="py-3 px-4">Nominal</th>
                                <th class="py-3 px-4">Status</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-gray-100 dark:divide-gray-700">
                            <tr>
                                <td class="py-3 px-4 text-sm font-medium">Pembayaran Tagihan
                                    #INV-2024-001</td>
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">25 Okt
                                    2024</td>
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">Pemasukan
                                </td>
                                <td class="py-3 px-4 text-sm font-medium text-green-600 dark:text-green-400">
                                    Rp 15.000.000</td>
                                <td class="py-3 px-4 text-sm">
                                    <span
                                        class="px-2 py-1 text-xs font-medium rounded-full bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200">Selesai</span>
                                </td>
                            </tr>
                            <tr>
                                <td class="py-3 px-4 text-sm font-medium">Biaya Gaji Karyawan - Okt
                                </td>
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">25 Okt
                                    2024</td>
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">Biaya</td>
                                <td class="py-3 px-4 text-sm font-medium text-red-600 dark:text-red-400">
                                    Rp 225.000.000</td>
                                <td class="py-3 px-4 text-sm">
                                    <span
                                        class="px-2 py-1 text-xs font-medium rounded-full bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200">Selesai</span>
                                </td>
                            </tr>
                            <tr>
                                <td class="py-3 px-4 text-sm font-medium">Tagihan #INV-2024-002 - PT
                                    Jaya Abadi</td>
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">24 Okt
                                    2024</td>
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">Piutang
                                </td>
                                <td class="py-3 px-4 text-sm font-medium text-gray-700 dark:text-gray-200">
                                    Rp 30.000.000</td>
                                <td class="py-3 px-4 text-sm">
                                    <span
                                        class="px-2 py-1 text-xs font-medium rounded-full bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200">Tertunda</span>
                                </td>
                            </tr>
                            <tr>
                                <td class="py-3 px-4 text-sm font-medium">Biaya Iklan Google Ads</td>
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">23 Okt
                                    2024</td>
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">Biaya</td>
                                <td class="py-3 px-4 text-sm font-medium text-red-600 dark:text-red-400">
                                    Rp 10.000.000</td>
                                <td class="py-3 px-4 text-sm">
                                    <span
                                        class="px-2 py-1 text-xs font-medium rounded-full bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200">Selesai</span>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </template>

    <template id="laporan-labarugi-content-template">
        <div class="space-y-6">
            <!-- Header Halaman L/R -->
            <div class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-md">
                <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center">
                    <div>
                        <h2 class="text-xl font-semibold">Laporan Laba Rugi</h2>
                        <p class="text-sm text-gray-500 dark:text-gray-400">Periode: 1 Jan 2024 - 31
                            Okt 2024</p>
                    </div>
                    <div class="flex space-x-2 mt-4 sm:mt-0">
                        <button data-toast="Fungsi ini belum tersedia."
                            class="btn-toast px-4 py-2 text-sm font-medium rounded-lg border border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-700">
                            <i data-feather="share-2" class="w-4 h-4 mr-2 inline-block"></i>Bagikan
                        </button>
                        <button data-toast="Fungsi ini belum tersedia."
                            class="btn-toast px-4 py-2 text-sm font-medium rounded-lg bg-indigo-600 text-white hover:bg-indigo-700">
                            <i data-feather="download" class="w-4 h-4 mr-2 inline-block"></i>Unduh
                        </button>
                    </div>
                </div>
            </div>

            <!-- Grafik L/R -->
            <div class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-md">
                <h3 class="text-lg font-semibold mb-4">Laba Rugi per Kuartal (dalam Jutaan Rp)</h3>
                <div class="h-96">
                    <canvas id="pnlChart"></canvas>
                </div>
            </div>

            <!-- Detail L/R -->
            <div class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-md overflow-x-auto">
                <h3 class="text-lg font-semibold mb-4">Detail Laporan</h3>
                <table class="w-full min-w-max">
                    <tbody class="divide-y divide-gray-100 dark:divide-gray-700">
                        <!-- Pendapatan -->
                        <tr class="font-semibold">
                            <td class="py-3 px-4">Pendapatan</td>
                            <td class="py-3 px-4 text-right"></td>
                            <td class="py-3 px-4 text-right text-lg">Rp 1.550.000.000</td>
                        </tr>
                        <tr class="text-sm">
                            <td class="py-2 px-4 pl-10 text-gray-600 dark:text-gray-300">Pendapatan
                                Jasa</td>
                            <td class="py-2 px-4 text-right text-gray-600 dark:text-gray-300">Rp
                                1.250.000.000</td>
                            <td class="py-2 px-4 text-right"></td>
                        </tr>
                        <tr class="text-sm">
                            <td class="py-2 px-4 pl-10 text-gray-600 dark:text-gray-300">Pendapatan
                                Lainnya</td>
                            <td class="py-2 px-4 text-right text-gray-600 dark:text-gray-300">Rp
                                300.000.000</td>
                            <td class="py-2 px-4 text-right"></td>
                        </tr>

                        <!-- HPP -->
                        <tr class="font-semibold">
                            <td class="py-3 px-4">Harga Pokok Penjualan (HPP)</td>
                            <td class="py-3 px-4 text-right"></td>
                            <td class="py-3 px-4 text-right text-lg text-red-600 dark:text-red-400">
                                (Rp 280.000.000)</td>
                        </tr>

                        <!-- Laba Kotor -->
                        <tr class="font-bold border-t-2 border-gray-200 dark:border-gray-700">
                            <td class="py-3 px-4">Laba Kotor</td>
                            <td class="py-3 px-4 text-right"></td>
                            <td class="py-3 px-4 text-right text-lg">Rp 1.270.000.000</td>
                        </tr>

                        <!-- Biaya Operasional -->
                        <tr class="font-semibold">
                            <td class="py-3 px-4">Biaya Operasional</td>
                            <td class="py-3 px-4 text-right"></td>
                            <td class="py-3 px-4 text-right text-lg text-red-600 dark:text-red-400">
                                (Rp 820.000.000)</td>
                        </tr>
                        <tr class="text-sm">
                            <td class="py-2 px-4 pl-10 text-gray-600 dark:text-gray-300">Biaya Gaji &
                                Tunjangan</td>
                            <td class="py-2 px-4 text-right text-gray-600 dark:text-gray-300">Rp
                                450.000.000</td>
                            <td class="py-2 px-4 text-right"></td>
                        </tr>
                        <tr class="text-sm">
                            <td class="py-2 px-4 pl-10 text-gray-600 dark:text-gray-300">Biaya
                                Marketing & Iklan</td>
                            <td class="py-2 px-4 text-right text-gray-600 dark:text-gray-300">Rp
                                180.000.000</td>
                            <td class="py-2 px-4 text-right"></td>
                        </tr>
                        <tr class="text-sm">
                            <td class="py-2 px-4 pl-10 text-gray-600 dark:text-gray-300">Biaya Sewa &
                                Utilitas</td>
                            <td class="py-2 px-4 text-right text-gray-600 dark:text-gray-300">Rp
                                135.000.000</td>
                            <td class="py-2 px-4 text-right"></td>
                        </tr>
                        <tr class="text-sm">
                            <td class="py-2 px-4 pl-10 text-gray-600 dark:text-gray-300">Biaya Lainnya
                            </td>
                            <td class="py-2 px-4 text-right text-gray-600 dark:text-gray-300">Rp
                                55.000.000</td>
                            <td class="py-2 px-4 text-right"></td>
                        </tr>

                        <!-- Laba Bersih -->
                        <tr
                            class="font-bold text-lg bg-indigo-50 dark:bg-indigo-900 border-t-2 border-indigo-200 dark:border-indigo-700">
                            <td class="py-4 px-4">Laba Bersih</td>
                            <td class="py-4 px-4 text-right"></td>
                            <td class="py-4 px-4 text-right text-indigo-600 dark:text-indigo-300">Rp
                                450.000.000</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </template>

    <template id="laporan-neraca-content-template">
        <div class="space-y-6">
            <!-- Header Halaman Neraca -->
            <div class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-md">
                <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center">
                    <div>
                        <h2 class="text-xl font-semibold">Laporan Neraca</h2>
                        <p class="text-sm text-gray-500 dark:text-gray-400">Per 31 Oktober 2024</p>
                    </div>
                    <button data-toast="Fungsi ini belum tersedia."
                        class="btn-toast px-4 py-2 mt-4 sm:mt-0 text-sm font-medium rounded-lg bg-indigo-600 text-white hover:bg-indigo-700">
                        <i data-feather="download" class="w-4 h-4 mr-2 inline-block"></i>Unduh
                    </button>
                </div>
            </div>

            <!-- Grafik Neraca -->
            <div class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-md">
                <h3 class="text-lg font-semibold mb-4">Struktur Aset vs Liabilitas & Ekuitas</h3>
                <!-- FIX: h-60 (lebih pendek) untuk chart horizontal -->
                <div class="h-60">
                    <canvas id="neracaChart"></canvas>
                </div>
            </div>

            <!-- Detail Neraca -->
            <div
                class="grid grid-cols-1 lg:grid-cols-2 gap-6 bg-white dark:bg-gray-800 p-6 rounded-xl shadow-md overflow-x-auto">
                <!-- Sisi Aset -->
                <div class="space-y-3">
                    <h3 class="text-lg font-semibold border-b pb-2 border-gray-200 dark:border-gray-700">
                        Aset</h3>
                    <table class="w-full">
                        <tbody class="divide-y divide-gray-100 dark:divide-gray-700">
                            <tr class="font-semibold">
                                <td class="py-2">Aset Lancar</td>
                                <td class="py-2 text-right">Rp 475.000.000</td>
                            </tr>
                            <tr class="text-sm">
                                <td class="py-2 pl-6 text-gray-600 dark:text-gray-300">Kas & Setara Kas
                                </td>
                                <td class="py-2 text-right text-gray-600 dark:text-gray-300">Rp
                                    400.000.000</td>
                            </tr>
                            <tr class="text-sm">
                                <td class="py-2 pl-6 text-gray-600 dark:text-gray-300">Piutang Usaha
                                </td>
                                <td class="py-2 text-right text-gray-600 dark:text-gray-300">Rp
                                    75.000.000</td>
                            </tr>
                            <tr class="font-semibold">
                                <td class="py-2">Aset Tetap</td>
                                <td class="py-2 text-right">Rp 400.000.000</td>
                            </tr>
                            <tr class="text-sm">
                                <td class="py-2 pl-6 text-gray-600 dark:text-gray-300">Peralatan</td>
                                <td class="py-2 text-right text-gray-600 dark:text-gray-300">Rp
                                    500.000.000</td>
                            </tr>
                            <tr class="text-sm">
                                <td class="py-2 pl-6 text-gray-600 dark:text-gray-300">Akum.
                                    Penyusutan</td>
                                <td class="py-2 text-right text-gray-600 dark:text-gray-300">(Rp
                                    100.000.000)</td>
                            </tr>
                            <tr class="font-bold text-lg border-t-2 border-gray-200 dark:border-gray-700">
                                <td class="py-3">Total Aset</td>
                                <td class="py-3 text-right">Rp 875.000.000</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Sisi Liabilitas & Ekuitas -->
                <div class="space-y-3">
                    <h3 class="text-lg font-semibold border-b pb-2 border-gray-200 dark:border-gray-700">
                        Liabilitas & Ekuitas</h3>
                    <table class="w-full">
                        <tbody class="divide-y divide-gray-100 dark:divide-gray-700">
                            <tr class="font-semibold">
                                <td class="py-2">Liabilitas</td>
                                <td class="py-2 text-right">Rp 275.000.000</td>
                            </tr>
                            <tr class="text-sm">
                                <td class="py-2 pl-6 text-gray-600 dark:text-gray-300">Hutang Usaha
                                </td>
                                <td class="py-2 text-right text-gray-600 dark:text-gray-300">Rp
                                    150.000.000</td>
                            </tr>
                            <tr class="text-sm">
                                <td class="py-2 pl-6 text-gray-600 dark:text-gray-300">Hutang Pajak
                                </td>
                                <td class="py-2 text-right text-gray-600 dark:text-gray-300">Rp
                                    25.000.000</td>
                            </tr>
                            <tr class="text-sm">
                                <td class="py-2 pl-6 text-gray-600 dark:text-gray-300">Hutang Bank (JK.
                                    Panjang)</td>
                                <td class="py-2 text-right text-gray-600 dark:text-gray-300">Rp
                                    100.000.000</td>
                            </tr>
                            <tr class="font-semibold">
                                <td class="py-2">Ekuitas</td>
                                <td class="py-2 text-right">Rp 600.000.000</td>
                            </tr>
                            <tr class="text-sm">
                                <td class="py-2 pl-6 text-gray-600 dark:text-gray-300">Modal Disetor
                                </td>
                                <td class="py-2 text-right text-gray-600 dark:text-gray-300">Rp
                                    150.000.000</td>
                            </tr>
                            <tr class="text-sm">
                                <td class="py-2 pl-6 text-gray-600 dark:text-gray-300">Laba Ditahan
                                </td>
                                <td class="py-2 text-right text-gray-600 dark:text-gray-300">Rp
                                    450.000.000</td>
                            </tr>
                            <tr class="font-bold text-lg border-t-2 border-gray-200 dark:border-gray-700">
                                <td class="py-3">Total Liabilitas & Ekuitas</td>
                                <td class="py-3 text-right">Rp 875.000.000</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </template>

    <template id="laporan-aruskas-content-template">
        <div class="space-y-6">
            <!-- Header Halaman Arus Kas -->
            <div class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-md">
                <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center">
                    <div>
                        <h2 class="text-xl font-semibold">Laporan Arus Kas</h2>
                        <p class="text-sm text-gray-500 dark:text-gray-400">Periode: 1 Jan 2024 - 31
                            Okt 2024</p>
                    </div>
                    <button data-toast="Fungsi ini belum tersedia."
                        class="btn-toast px-4 py-2 mt-4 sm:mt-0 text-sm font-medium rounded-lg bg-indigo-600 text-white hover:bg-indigo-700">
                        <i data-feather="download" class="w-4 h-4 mr-2 inline-block"></i>Unduh
                    </button>
                </div>
            </div>

            <!-- (PERBAIKAN) Grafik Waterfall Arus Kas -->
            <div class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-md">
                <h3 class="text-lg font-semibold mb-4">Pergerakan Arus Kas (Waterfall Chart)</h3>
                <p class="text-sm text-gray-500 dark:text-gray-400 mb-4">Menunjukkan bagaimana Saldo
                    Awal Kas berubah menjadi Saldo Akhir Kas (dalam Jutaan Rp).</p>
                <div class="h-96">
                    <canvas id="cashFlowChart"></canvas>
                </div>
            </div>

            <!-- Detail Arus Kas -->
            <div class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-md overflow-x-auto">
                <h3 class="text-lg font-semibold mb-4">Detail Arus Kas</h3>
                <table class="w-full min-w-max">
                    <tbody class="divide-y divide-gray-100 dark:divide-gray-700">
                        <!-- Operasi -->
                        <tr class="font-semibold">
                            <td class="py-3 px-4">Arus Kas dari Aktivitas Operasi</td>
                            <td class="py-3 px-4 text-right"></td>
                            <td class="py-3 px-4 text-right text-lg text-green-600 dark:text-green-400">
                                Rp 500.000.000</td>
                        </tr>
                        <tr class="text-sm">
                            <td class="py-2 px-4 pl-10 text-gray-600 dark:text-gray-300">Penerimaan
                                dari Pelanggan</td>
                            <td class="py-2 px-4 text-right text-gray-600 dark:text-gray-300">Rp
                                1.500.000.000</td>
                            <td class="py-2 px-4 text-right"></td>
                        </tr>
                        <tr class="text-sm">
                            <td class="py-2 px-4 pl-10 text-gray-600 dark:text-gray-300">Pembayaran ke
                                Pemasok & Karyawan</td>
                            <td class="py-2 px-4 text-right text-gray-600 dark:text-gray-300">(Rp
                                1.000.000.000)</td>
                            <td class="py-2 px-4 text-right"></td>
                        </tr>

                        <!-- Investasi -->
                        <tr class="font-semibold">
                            <td class="py-3 px-4">Arus Kas dari Aktivitas Investasi</td>
                            <td class="py-3 px-4 text-right"></td>
                            <td class="py-3 px-4 text-right text-lg text-red-600 dark:text-red-400">
                                (Rp 250.000.000)</td>
                        </tr>
                        <tr class="text-sm">
                            <td class="py-2 px-4 pl-10 text-gray-600 dark:text-gray-300">Pembelian Aset
                                Tetap (Peralatan)</td>
                            <td class="py-2 px-4 text-right text-gray-600 dark:text-gray-300">(Rp
                                250.000.000)</td>
                            <td class="py-2 px-4 text-right"></td>
                        </tr>

                        <!-- Pendanaan -->
                        <tr class="font-semibold">
                            <td class="py-3 px-4">Arus Kas dari Aktivitas Pendanaan</td>
                            <td class="py-3 px-4 text-right"></td>
                            <td class="py-3 px-4 text-right text-lg text-green-600 dark:text-green-400">
                                Rp 50.000.000</td>
                        </tr>
                        <tr class="text-sm">
                            <td class="py-2 px-4 pl-10 text-gray-600 dark:text-gray-300">Penerimaan
                                Pinjaman Bank</td>
                            <td class="py-2 px-4 text-right text-gray-600 dark:text-gray-300">Rp
                                100.000.000</td>
                            <td class="py-2 px-4 text-right"></td>
                        </tr>
                        <tr class="text-sm">
                            <td class="py-2 px-4 pl-10 text-gray-600 dark:text-gray-300">Pembayaran
                                Dividen</td>
                            <td class="py-2 px-4 text-right text-gray-600 dark:text-gray-300">(Rp
                                50.000.000)</td>
                            <td class="py-2 px-4 text-right"></td>
                        </tr>

                        <!-- Kenaikan Kas -->
                        <tr class="font-bold border-t-2 border-gray-200 dark:border-gray-700">
                            <td class="py-3 px-4">Kenaikan (Penurunan) Kas</td>
                            <td class="py-3 px-4 text-right"></td>
                            <td class="py-3 px-4 text-right text-lg">Rp 300.000.000</td>
                        </tr>

                        <!-- Saldo Awal -->
                        <tr class="font-semibold">
                            <td class="py-3 px-4">Saldo Kas Awal Periode</td>
                            <td class="py-3 px-4 text-right"></td>
                            <td class="py-3 px-4 text-right text-lg">Rp 100.000.000</td>
                        </tr>

                        <!-- Saldo Akhir -->
                        <tr
                            class="font-bold text-lg bg-indigo-50 dark:bg-indigo-900 border-t-2 border-indigo-200 dark:border-indigo-700">
                            <td class="py-4 px-4">Saldo Kas Akhir Periode</td>
                            <td class="py-4 px-4 text-right"></td>
                            <td class="py-4 px-4 text-right text-indigo-600 dark:text-indigo-300">Rp
                                400.000.000</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </template>

    <!-- (BARU) Template Laporan Biaya -->
    <template id="laporan-biaya-content-template">
        <div class="space-y-6">
            <!-- Header Halaman -->
            <div class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-md">
                <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center">
                    <div>
                        <h2 class="text-xl font-semibold">Laporan Biaya per Departemen</h2>
                        <p class="text-sm text-gray-500 dark:text-gray-400">Menunjukkan alokasi biaya
                            operasional (Cost Center)</p>
                    </div>
                    <div class="flex space-x-2 mt-4 sm:mt-0">
                        <select
                            class="text-sm rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500">
                            <option>Bulan Ini</option>
                            <option>Kuartal Ini</option>
                            <option>Tahun Ini</option>
                        </select>
                        <button data-toast="Fungsi ini belum tersedia."
                            class="btn-toast px-4 py-2 text-sm font-medium rounded-lg bg-indigo-600 text-white hover:bg-indigo-700">
                            <i data-feather="download" class="w-4 h-4 mr-2 inline-block"></i>Unduh
                        </button>
                    </div>
                </div>
            </div>

            <!-- Ringkasan & Grafik Donut -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <!-- Ringkasan Biaya -->
                <div class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-md">
                    <p class="text-sm font-medium text-gray-500 dark:text-gray-400">Total Biaya
                        Operasional</p>
                    <p class="text-3xl font-bold text-red-600 dark:text-red-400">Rp 450.000.000</p>
                    <p class="text-sm text-gray-500 dark:text-gray-400 mt-2">Periode 1-31 Okt 2024</p>
                    <hr class="my-4 border-gray-200 dark:border-gray-700">
                    <h4 class="font-semibold mb-3">Top 3 Biaya</h4>
                    <ul class="space-y-2 text-sm">
                        <li class="flex justify-between">
                            <span>Gaji & Tunjangan</span>
                            <span class="font-medium">Rp 225 Jt</span>
                        </li>
                        <li class="flex justify-between">
                            <span>Marketing & Iklan</span>
                            <span class="font-medium">Rp 90 Jt</span>
                        </li>
                        <li class="flex justify-between">
                            <span>Sewa & Utilitas</span>
                            <span class="font-medium">Rp 67.5 Jt</span>
                        </li>
                    </ul>
                </div>

                <!-- Grafik Donut -->
                <div class="lg:col-span-2 bg-white dark:bg-gray-800 p-6 rounded-xl shadow-md">
                    <h3 class="text-lg font-semibold mb-4">Alokasi Biaya</h3>
                    <div class="h-80">
                        <canvas id="costCenterChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Detail Tabel Biaya -->
            <div class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-md">
                <h3 class="text-lg font-semibold mb-4">Detail Biaya per Departemen</h3>
                <div class="overflow-x-auto">
                    <table class="w-full min-w-max">
                        <thead>
                            <tr
                                class="border-b border-gray-200 dark:border-gray-700 text-left text-xs text-gray-500 dark:text-gray-400 uppercase">
                                <th class="py-3 px-4">Departemen (Cost Center)</th>
                                <th class="py-3 px-4">Anggaran (Bulan)</th>
                                <th class="py-3 px-4">Aktual (Bulan)</th>
                                <th class="py-3 px-4">Varian</th>
                                <th class="py-3 px-4">Status Varian</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-gray-100 dark:divide-gray-700">
                            <tr>
                                <td class="py-3 px-4 text-sm font-medium">Gaji & Tunjangan (HR)</td>
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">Rp
                                    220.000.000</td>
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">Rp
                                    225.000.000</td>
                                <td class="py-3 px-4 text-sm font-medium text-red-600 dark:text-red-400">
                                    (Rp 5.000.000)</td>
                                <td class="py-3 px-4 text-sm">
                                    <span
                                        class="px-2 py-1 text-xs font-medium rounded-full bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200">Over
                                        Budget</span>
                                </td>
                            </tr>
                            <tr>
                                <td class="py-3 px-4 text-sm font-medium">Marketing & Iklan (Sales)
                                </td>
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">Rp
                                    100.000.000</td>
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">Rp
                                    90.000.000</td>
                                <td class="py-3 px-4 text-sm font-medium text-green-600 dark:text-green-400">
                                    Rp 10.000.000</td>
                                <td class="py-3 px-4 text-sm">
                                    <span
                                        class="px-2 py-1 text-xs font-medium rounded-full bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200">Saving</span>
                                </td>
                            </tr>
                            <tr>
                                <td class="py-3 px-4 text-sm font-medium">Sewa & Utilitas (GA)</td>
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">Rp
                                    70.000.000</td>
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">Rp
                                    67.500.000</td>
                                <td class="py-3 px-4 text-sm font-medium text-green-600 dark:text-green-400">
                                    Rp 2.500.000</td>
                                <td class="py-3 px-4 text-sm">
                                    <span
                                        class="px-2 py-1 text-xs font-medium rounded-full bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200">Saving</span>
                                </td>
                            </tr>
                            <tr>
                                <td class="py-3 px-4 text-sm font-medium">Lainnya (GA)</td>
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">Rp
                                    70.000.000</td>
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">Rp
                                    67.500.000</td>
                                <td class="py-3 px-4 text-sm font-medium text-green-600 dark:text-green-400">
                                    Rp 2.500.000</td>
                                <td class="py-3 px-4 text-sm">
                                    <span
                                        class="px-2 py-1 text-xs font-medium rounded-full bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200">Saving</span>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </template>

    <!-- (MODIFIKASI) Template Halaman Faktur Penjualan -->
    <template id="faktur-penjualan-content-template">
        <div class="space-y-6">
            <!-- Header Halaman Faktur -->
            <div class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-md">
                <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center">
                    <div>
                        <h2 class="text-xl font-semibold">Faktur Penjualan (Piutang Usaha)</h2>
                        <p class="text-sm text-gray-500 dark:text-gray-400">Total Piutang: Rp
                            75.000.000</p>
                    </div>
                    <button id="faktur-buat-faktur"
                        class="px-4 py-2 mt-4 sm:mt-0 text-sm font-medium rounded-lg bg-indigo-600 text-white hover:bg-indigo-700">
                        <i data-feather="plus" class="w-4 h-4 mr-2 inline-block"></i>Buat Faktur Baru
                    </button>
                </div>
                <hr class="my-4 border-gray-200 dark:border-gray-700">
                <!-- Filter -->
                <div class="flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-2">
                    <input type="text" id="invoice-search-input"
                        class="pl-10 pr-4 py-2 w-full sm:w-72 rounded-lg border border-gray-300 dark:border-gray-700 bg-gray-50 dark:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500"
                        placeholder="Cari No. Faktur atau Pelanggan...">
                    <select
                        class="text-sm rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500">
                        <option>Semua Status</option>
                        <option>Lunas</option>
                        <option>Tertunda</option>
                        <option>Jatuh Tempo</option>
                    </select>
                </div>
            </div>

            <!-- Tabel Daftar Faktur -->
            <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md overflow-hidden">
                <div class="overflow-x-auto">
                    <table class="w-full min-w-max">
                        <thead>
                            <tr
                                class="border-b border-gray-200 dark:border-gray-700 text-left text-xs text-gray-500 dark:text-gray-400 uppercase">
                                <th class="py-3 px-4">No. Faktur</th>
                                <th class="py-3 px-4">Pelanggan</th>
                                <th class="py-3 px-4">Tgl. Terbit</th>
                                <th class="py-3 px-4">Tgl. Jatuh Tempo</th>
                                <th class="py-3 px-4">Total</th>
                                <th class="py-3 px-4">Status</th>
                                <th class="py-3 px-4">Aksi</th>
                            </tr>
                        </thead>
                        <tbody id="invoice-table-body"
                            class="divide-y divide-gray-100 dark:divide-gray-700">
                            <!-- Baris 1 -->
                            <tr>
                                <td class="py-3 px-4 text-sm font-medium">INV-2024-001</td>
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">PT Maju
                                    Mundur</td>
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">10 Okt
                                    2024</td>
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">25 Okt
                                    2024</td>
                                <td class="py-3 px-4 text-sm font-medium">Rp 15.000.000</td>
                                <td class="py-3 px-4 text-sm">
                                    <span
                                        class="px-2 py-1 text-xs font-medium rounded-full bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200">Lunas</span>
                                </td>
                                <td class="py-3 px-4 text-sm">
                                    <button data-toast="Fungsi ini belum tersedia."
                                        class="btn-toast text-indigo-600 dark:text-indigo-400 hover:underline">Lihat</button>
                                </td>
                            </tr>
                            <!-- Baris 2 -->
                            <tr>
                                <td class="py-3 px-4 text-sm font-medium">INV-2024-002</td>
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">PT Jaya
                                    Abadi</td>
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">24 Okt
                                    2024</td>
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">08 Nov
                                    2024</td>
                                <td class="py-3 px-4 text-sm font-medium">Rp 30.000.000</td>
                                <td class="py-3 px-4 text-sm">
                                    <span
                                        class="px-2 py-1 text-xs font-medium rounded-full bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200">Tertunda</span>
                                </td>
                                <td class="py-3 px-4 text-sm">
                                    <button data-toast="Fungsi ini belum tersedia."
                                        class="btn-toast text-indigo-600 dark:text-indigo-400 hover:underline">Lihat</button>
                                </td>
                            </tr>
                            <!-- Baris 3 -->
                            <tr>
                                <td class="py-3 px-4 text-sm font-medium">INV-2024-003</td>
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">CV Sinar
                                    Terang</td>
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">15 Sep
                                    2024</td>
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">30 Sep
                                    2024</td>
                                <td class="py-3 px-4 text-sm font-medium">Rp 45.000.000</td>
                                <td class="py-3 px-4 text-sm">
                                    <span
                                        class="px-2 py-1 text-xs font-medium rounded-full bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200">Jatuh
                                        Tempo</span>
                                </td>
                                <td class="py-3 px-4 text-sm">
                                    <button data-toast="Fungsi ini belum tersedia."
                                        class="btn-toast text-indigo-600 dark:text-indigo-400 hover:underline">Lihat</button>
                                </td>
                            </tr>
                            <!-- Data baru akan ditambahkan di sini oleh JS -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </template>

    <!-- (BARU) Template Pesanan Penjualan -->
    <template id="pesanan-penjualan-content-template">
        <div class="space-y-6">
            <!-- Header Halaman -->
            <div class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-md">
                <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center">
                    <div>
                        <h2 class="text-xl font-semibold">Pesanan Penjualan (Sales Order)</h2>
                        <p class="text-sm text-gray-500 dark:text-gray-400">Daftar SO yang menunggu
                            diproses.</p>
                    </div>
                    <button id="btn-buat-so"
                        class="px-4 py-2 mt-4 sm:mt-0 text-sm font-medium rounded-lg bg-indigo-600 text-white hover:bg-indigo-700">
                        <i data-feather="plus" class="w-4 h-4 mr-2 inline-block"></i>Buat SO Baru
                    </button>
                </div>
                <hr class="my-4 border-gray-200 dark:border-gray-700">
                <!-- Filter -->
                <input type="text"
                    class="pl-10 pr-4 py-2 w-full sm:w-72 rounded-lg border border-gray-300 dark:border-gray-700 bg-gray-50 dark:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500"
                    placeholder="Cari No. SO atau Pelanggan...">
            </div>

            <!-- Tabel Daftar SO -->
            <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md overflow-hidden">
                <div class="overflow-x-auto">
                    <table class="w-full min-w-max">
                        <thead>
                            <tr
                                class="border-b border-gray-200 dark:border-gray-700 text-left text-xs text-gray-500 dark:text-gray-400 uppercase">
                                <th class="py-3 px-4">No. SO</th>
                                <th class="py-3 px-4">Pelanggan</th>
                                <th class="py-3 px-4">Tanggal</th>
                                <th class="py-3 px-4">Total</th>
                                <th class="py-3 px-4">Status</th>
                                <th class="py-3 px-4">Aksi</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-gray-100 dark:divide-gray-700">
                            <tr>
                                <td class="py-3 px-4 text-sm font-medium">SO-2024-101</td>
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">PT Jaya
                                    Abadi</td>
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">23 Okt
                                    2024</td>
                                <td class="py-3 px-4 text-sm font-medium">Rp 30.000.000</td>
                                <td class="py-3 px-4 text-sm">
                                    <span
                                        class="px-2 py-1 text-xs font-medium rounded-full bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200">Ditagih</span>
                                </td>
                                <td class="py-3 px-4 text-sm">
                                    <button data-toast="Fungsi ini belum tersedia."
                                        class="btn-toast text-indigo-600 dark:text-indigo-400 hover:underline">Lihat</button>
                                </td>
                            </tr>
                            <tr>
                                <td class="py-3 px-4 text-sm font-medium">SO-2024-100</td>
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">PT Maju
                                    Mundur</td>
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">09 Okt
                                    2024</td>
                                <td class="py-3 px-4 text-sm font-medium">Rp 15.000.000</td>
                                <td class="py-3 px-4 text-sm">
                                    <span
                                        class="px-2 py-1 text-xs font-medium rounded-full bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200">Selesai</span>
                                </td>
                                <td class="py-3 px-4 text-sm">
                                    <button data-toast="Fungsi ini belum tersedia."
                                        class="btn-toast text-indigo-600 dark:text-indigo-400 hover:underline">Lihat</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </template>

    <!-- (BARU) Template Pesanan Pembelian -->
    <template id="pesanan-pembelian-content-template">
        <div class="space-y-6">
            <!-- Header Halaman -->
            <div class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-md">
                <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center">
                    <div>
                        <h2 class="text-xl font-semibold">Pesanan Pembelian (Purchase Order)</h2>
                        <p class="text-sm text-gray-500 dark:text-gray-400">Daftar PO yang dikirim ke
                            supplier.</p>
                    </div>
                    <button id="btn-buat-po"
                        class="px-4 py-2 mt-4 sm:mt-0 text-sm font-medium rounded-lg bg-indigo-600 text-white hover:bg-indigo-700">
                        <i data-feather="plus" class="w-4 h-4 mr-2 inline-block"></i>Buat PO Baru
                    </button>
                </div>
            </div>

            <!-- Tabel Daftar PO -->
            <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md overflow-hidden">
                <div class="overflow-x-auto">
                    <table class="w-full min-w-max">
                        <thead>
                            <tr
                                class="border-b border-gray-200 dark:border-gray-700 text-left text-xs text-gray-500 dark:text-gray-400 uppercase">
                                <th class="py-3 px-4">No. PO</th>
                                <th class="py-3 px-4">Supplier</th>
                                <th class="py-3 px-4">Tanggal</th>
                                <th class="py-3 px-4">Total</th>
                                <th class="py-3 px-4">Status</th>
                                <th class="py-3 px-4">Aksi</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-gray-100 dark:divide-gray-700">
                            <tr>
                                <td class="py-3 px-4 text-sm font-medium">PO-2024-051</td>
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">PT Gedung
                                    Sejahtera</td>
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">20 Okt
                                    2024</td>
                                <td class="py-3 px-4 text-sm font-medium">Rp 50.000.000</td>
                                <td class="py-3 px-4 text-sm">
                                    <span
                                        class="px-2 py-1 text-xs font-medium rounded-full bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200">Ditagih</span>
                                </td>
                                <td class="py-3 px-4 text-sm">
                                    <button data-toast="Fungsi ini belum tersedia."
                                        class="btn-toast text-indigo-600 dark:text-indigo-400 hover:underline">Lihat</button>
                                </td>
                            </tr>
                            <tr>
                                <td class="py-3 px-4 text-sm font-medium">PO-2024-050</td>
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">PT Office
                                    Sukses</td>
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">15 Okt
                                    2024</td>
                                <td class="py-3 px-4 text-sm font-medium">Rp 15.000.000</td>
                                <td class="py-3 px-4 text-sm">
                                    <span
                                        class="px-2 py-1 text-xs font-medium rounded-full bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200">Menunggu
                                        Barang</span>
                                </td>
                                <td class="py-3 px-4 text-sm">
                                    <button data-toast="Fungsi ini belum tersedia."
                                        class="btn-toast text-indigo-600 dark:text-indigo-400 hover:underline">Lihat</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </template>

    <!-- (BARU) Template Faktur Pembelian -->
    <template id="faktur-pembelian-content-template">
        <div class="space-y-6">
            <!-- Header Halaman -->
            <div class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-md">
                <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center">
                    <div>
                        <h2 class="text-xl font-semibold">Faktur Pembelian (Hutang Usaha)</h2>
                        <p class="text-sm text-gray-500 dark:text-gray-400">Total Hutang Usaha: Rp
                            150.000.000</p>
                    </div>
                    <button id="btn-catat-faktur-beli"
                        class="px-4 py-2 mt-4 sm:mt-0 text-sm font-medium rounded-lg bg-indigo-600 text-white hover:bg-indigo-700">
                        <i data-feather="plus" class="w-4 h-4 mr-2 inline-block"></i>Catat Faktur Beli
                    </button>
                </div>
            </div>

            <!-- Tabel Daftar Faktur Beli -->
            <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md overflow-hidden">
                <div class="overflow-x-auto">
                    <table class="w-full min-w-max">
                        <thead>
                            <tr
                                class="border-b border-gray-200 dark:border-gray-700 text-left text-xs text-gray-500 dark:text-gray-400 uppercase">
                                <th class="py-3 px-4">No. Tagihan</th>
                                <th class="py-3 px-4">Supplier</th>
                                <th class="py-3 px-4">Tgl. Tagihan</th>
                                <th class="py-3 px-4">Tgl. Jatuh Tempo</th>
                                <th class="py-3 px-4">Total</th>
                                <th class="py-3 px-4">Status</th>
                                <th class="py-3 px-4">Aksi</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-gray-100 dark:divide-gray-700">
                            <tr>
                                <td class="py-3 px-4 text-sm font-medium">INV-GS-001</td>
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">PT Gedung
                                    Sejahtera</td>
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">21 Okt
                                    2024</td>
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">05 Nov
                                    2024</td>
                                <td class="py-3 px-4 text-sm font-medium">Rp 50.000.000</td>
                                <td class="py-3 px-4 text-sm">
                                    <span
                                        class="px-2 py-1 text-xs font-medium rounded-full bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200">Belum
                                        Dibayar</span>
                                </td>
                                <td class="py-3 px-4 text-sm">
                                    <button data-toast="Fungsi ini belum tersedia."
                                        class="btn-toast text-indigo-600 dark:text-indigo-400 hover:underline">Bayar</button>
                                </td>
                            </tr>
                            <tr>
                                <td class="py-3 px-4 text-sm font-medium">INV-OS-088</td>
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">PT Office
                                    Sukses</td>
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">18 Okt
                                    2024</td>
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">02 Nov
                                    2024</td>
                                <td class="py-3 px-4 text-sm font-medium">Rp 15.000.000</td>
                                <td class="py-3 px-4 text-sm">
                                    <span
                                        class="px-2 py-1 text-xs font-medium rounded-full bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200">Belum
                                        Dibayar</span>
                                </td>
                                <td class="py-3 px-4 text-sm">
                                    <button data-toast="Fungsi ini belum tersedia."
                                        class="btn-toast text-indigo-600 dark:text-indigo-400 hover:underline">Bayar</button>
                                </td>
                            </tr>
                            <tr>
                                <td class="py-3 px-4 text-sm font-medium">INV-GA-030</td>
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">Google
                                    Asia Pacific</td>
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">01 Okt
                                    2024</td>
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">20 Okt
                                    2024</td>
                                <td class="py-3 px-4 text-sm font-medium">Rp 10.000.000</td>
                                <td class="py-3 px-4 text-sm">
                                    <span
                                        class="px-2 py-1 text-xs font-medium rounded-full bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200">Lunas</span>
                                </td>
                                <td class="py-3 px-4 text-sm">
                                    <button data-toast="Fungsi ini belum tersedia."
                                        class="btn-toast text-indigo-600 dark:text-indigo-400 hover:underline">Lihat</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </template>

    <template id="buku-besar-content-template">
        <div class="space-y-6">
            <!-- Header Halaman Buku Besar -->
            <div class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-md">
                <h2 class="text-xl font-semibold">Buku Besar</h2>
                <p class="text-sm text-gray-500 dark:text-gray-400 mb-4">Melihat semua entri jurnal
                    transaksi.</p>
                <!-- Filter -->
                <div class="flex flex-col sm:flex-row space-y-3 sm:space-y-0 sm:space-x-3">
                    <div class="flex-1">
                        <label class="text-xs font-medium text-gray-600 dark:text-gray-300">Akun</label>
                        <select
                            class="w-full text-sm rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500">
                            <option value="10100">(10100) Kas & Setara Kas</option>
                            <option value="10200">(10200) Piutang Usaha</option>
                            <option value="40100">(40100) Pendapatan Jasa</option>
                            <option value="50100">(50100) Biaya Gaji</option>
                        </select>
                    </div>
                    <div class="flex-1">
                        <label class="text-xs font-medium text-gray-600 dark:text-gray-300">Tgl.
                            Mulai</label>
                        <input type="date"
                            class="w-full text-sm rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500">
                    </div>
                    <div class="flex-1">
                        <label class="text-xs font-medium text-gray-600 dark:text-gray-300">Tgl.
                            Selesai</label>
                        <input type="date"
                            class="w-full text-sm rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500">
                    </div>
                    <div class="flex-none self-end">
                        <button id="apply-gl-filter"
                            class="w-full px-4 py-2 text-sm font-medium rounded-lg bg-indigo-600 text-white hover:bg-indigo-700">
                            Terapkan
                        </button>
                    </div>
                </div>
            </div>

            <!-- Tabel Buku Besar -->
            <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md overflow-hidden">
                <div class="overflow-x-auto">
                    <table class="w-full min-w-max">
                        <thead>
                            <tr
                                class="border-b border-gray-200 dark:border-gray-700 text-left text-xs text-gray-500 dark:text-gray-400 uppercase">
                                <th class="py-3 px-4">Tanggal</th>
                                <th class="py-3 px-4">No. Jurnal</th>
                                <th class="py-3 px-4">Deskripsi</th>
                                <th class="py-3 px-4">Debit</th>
                                <th class="py-3 px-4">Kredit</th>
                                <th class="py-3 px-4">Saldo</th>
                            </tr>
                        </thead>
                        <tbody id="gl-table-body"
                            class="divide-y divide-gray-100 dark:divide-gray-700">
                            <!-- Data akan dimuat berdasarkan filter -->
                            <tr id="gl-row-1">
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">01 Okt
                                    2024</td>
                                <td class="py-3 px-4 text-sm font-medium">JE-001</td>
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">Saldo
                                    Awal</td>
                                <td class="py-3 px-4 text-sm font-medium text-right">Rp 100.000.000
                                </td>
                                <td class="py-3 px-4 text-sm font-medium text-right">Rp 0</td>
                                <td class="py-3 px-4 text-sm font-medium text-right">Rp 100.000.000
                                </td>
                            </tr>
                            <tr id="gl-row-2">
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">10 Okt
                                    2024</td>
                                <td class="py-3 px-4 text-sm font-medium">JE-002</td>
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">
                                    Penerimaan INV-2024-001</td>
                                <td class="py-3 px-4 text-sm font-medium text-right">Rp 15.000.000</td>
                                <td class="py-3 px-4 text-sm font-medium text-right">Rp 0</td>
                                <td class="py-3 px-4 text-sm font-medium text-right">Rp 115.000.000
                                </td>
                            </tr>
                            <tr id="gl-row-3">
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">23 Okt
                                    2024</td>
                                <td class="py-3 px-4 text-sm font-medium">JE-003</td>
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">Biaya
                                    Iklan Google Ads</td>
                                <td class="py-3 px-4 text-sm font-medium text-right">Rp 0</td>
                                <td class="py-3 px-4 text-sm font-medium text-right text-red-600 dark:text-red-400">
                                    Rp 10.000.000</td>
                                <td class="py-3 px-4 text-sm font-medium text-right">Rp 105.000.000
                                </td>
                            </tr>
                            <tr id="gl-row-4">
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">25 Okt
                                    2024</td>
                                <td class="py-3 px-4 text-sm font-medium">JE-004</td>
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">Biaya
                                    Gaji Karyawan - Okt</td>
                                <td class="py-3 px-4 text-sm font-medium text-right">Rp 0</td>
                                <td class="py-3 px-4 text-sm font-medium text-right text-red-600 dark:text-red-400">
                                    Rp 225.000.000</td>
                                <td class="py-3 px-4 text-sm font-medium text-right text-red-600 dark:text-red-400">
                                    (Rp 120.000.000)</td>
                            </tr>
                            <tr id="gl-row-5">
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">...</td>
                                <td class="py-3 px-4 text-sm font-medium">...</td>
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">...
                                </td>
                                <td class="py-3 px-4 text-sm font-medium text-right">...</td>
                                <td class="py-3 px-4 text-sm font-medium text-right">...</td>
                                <td class="py-3 px-4 text-sm font-medium text-right">Rp 400.000.000
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </template>

    <!-- (MODIFIKASI) Template Master Data: Pelanggan (dengan UI CRUD) -->
    <template id="data-pelanggan-content-template">
        <div class="space-y-6">
            <!-- Header Halaman -->
            <div class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-md">
                <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center">
                    <div>
                        <h2 class="text-xl font-semibold">Master Data Pelanggan</h2>
                        <p class="text-sm text-gray-500 dark:text-gray-400">Daftar semua pelanggan
                            perusahaan.</p>
                    </div>
                    <button id="btn-pelanggan-baru"
                        class="px-4 py-2 mt-4 sm:mt-0 text-sm font-medium rounded-lg bg-indigo-600 text-white hover:bg-indigo-700">
                        <i data-feather="plus" class="w-4 h-4 mr-2 inline-block"></i>Pelanggan Baru
                    </button>
                </div>
                <hr class="my-4 border-gray-200 dark:border-gray-700">
                <!-- Filter -->
                <input type="text"
                    class="pl-10 pr-4 py-2 w-full sm:w-72 rounded-lg border border-gray-300 dark:border-gray-700 bg-gray-50 dark:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500"
                    placeholder="Cari nama pelanggan atau ID...">
            </div>

            <!-- Tabel Data Pelanggan -->
            <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md overflow-hidden">
                <div class="overflow-x-auto">
                    <table class="w-full min-w-max">
                        <thead>
                            <tr
                                class="border-b border-gray-200 dark:border-gray-700 text-left text-xs text-gray-500 dark:text-gray-400 uppercase">
                                <th class="py-3 px-4">ID Pelanggan</th>
                                <th class="py-3 px-4">Nama Pelanggan</th>
                                <th class="py-3 px-4">Email</th>
                                <th class="py-3 px-4">Telepon</th>
                                <th class="py-3 px-4">Total Piutang</th>
                                <th class="py-3 px-4">Aksi</th>
                            </tr>
                        </thead>
                        <tbody id="pelanggan-table-body"
                            class="divide-y divide-gray-100 dark:divide-gray-700">
                            <!-- Data dummy akan di-render oleh JS -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </template>

    <!-- (MODIFIKASI) Template Master Data: Supplier (dengan UI CRUD) -->
    <template id="data-supplier-content-template">
        <div class="space-y-6">
            <!-- Header Halaman -->
            <div class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-md">
                <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center">
                    <div>
                        <h2 class="text-xl font-semibold">Master Data Supplier</h2>
                        <p class="text-sm text-gray-500 dark:text-gray-400">Daftar semua supplier &
                            vendor.</p>
                    </div>
                    <button id="btn-supplier-baru"
                        class="px-4 py-2 mt-4 sm:mt-0 text-sm font-medium rounded-lg bg-indigo-600 text-white hover:bg-indigo-700">
                        <i data-feather="plus" class="w-4 h-4 mr-2 inline-block"></i>Supplier Baru
                    </button>
                </div>
            </div>

            <!-- Tabel Data Supplier -->
            <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md overflow-hidden">
                <div class="overflow-x-auto">
                    <table class="w-full min-w-max">
                        <thead>
                            <tr
                                class="border-b border-gray-200 dark:border-gray-700 text-left text-xs text-gray-500 dark:text-gray-400 uppercase">
                                <th class="py-3 px-4">ID Supplier</th>
                                <th class="py-3 px-4">Nama Supplier</th>
                                <th class="py-3 px-4">Kategori</th>
                                <th class="py-3 px-4">Total Hutang</th>
                                <th class="py-3 px-4">Aksi</th>
                            </tr>
                        </thead>
                        <tbody id="supplier-table-body"
                            class="divide-y divide-gray-100 dark:divide-gray-700">
                            <tr>
                                <td class="py-3 px-4 text-sm font-medium">SUP-001</td>
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">PT
                                    Office Sukses</td>
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">ATK &
                                    Perlengkapan</td>
                                <td class="py-3 px-4 text-sm font-medium text-yellow-600 dark:text-yellow-400">Rp
                                    15.000.000</td>
                                <td class="py-3 px-4 text-sm space-x-2">
                                    <button
                                        class="btn-edit-supplier text-indigo-600 dark:text-indigo-400 hover:text-indigo-800 dark:hover:text-indigo-200 p-1">
                                        <i data-feather="edit-2" class="w-4 h-4"></i>
                                    </button>
                                    <button
                                        class="btn-delete-supplier text-red-500 dark:text-red-400 hover:text-red-700 dark:hover:text-red-200 p-1">
                                        <i data-feather="trash-2" class="w-4 h-4"></i>
                                    </button>
                                </td>
                            </tr>
                            <tr>
                                <td class="py-3 px-4 text-sm font-medium">SUP-002</td>
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">Google
                                    Asia Pacific</td>
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">Digital
                                    Marketing</td>
                                <td class="py-3 px-4 text-sm font-medium">Rp 0</td>
                                <td class="py-3 px-4 text-sm space-x-2">
                                    <button
                                        class="btn-edit-supplier text-indigo-600 dark:text-indigo-400 hover:text-indigo-800 dark:hover:text-indigo-200 p-1">
                                        <i data-feather="edit-2" class="w-4 h-4"></i>
                                    </button>
                                    <button
                                        class="btn-delete-supplier text-red-500 dark:text-red-400 hover:text-red-700 dark:hover:text-red-200 p-1">
                                        <i data-feather="trash-2" class="w-4 h-4"></i>
                                    </button>
                                </td>
                            </tr>
                            <tr>
                                <td class="py-3 px-4 text-sm font-medium">SUP-003</td>
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">PT Gedung
                                    Sejahtera</td>
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">Sewa &
                                    Utilitas</td>
                                <td class="py-3 px-4 text-sm font-medium text-yellow-600 dark:text-yellow-400">Rp
                                    50.000.000</td>
                                <td class="py-3 px-4 text-sm space-x-2">
                                    <button
                                        class="btn-edit-supplier text-indigo-600 dark:text-indigo-400 hover:text-indigo-800 dark:hover:text-indigo-200 p-1">
                                        <i data-feather="edit-2" class="w-4 h-4"></i>
                                    </button>
                                    <button
                                        class="btn-delete-supplier text-red-500 dark:text-red-400 hover:text-red-700 dark:hover:text-red-200 p-1">
                                        <i data-feather="trash-2" class="w-4 h-4"></i>
                                    </button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </template>

    <!-- (MODIFIKASI) Template Master Data: Daftar Akun (COA) (dengan UI CRUD) -->
    <template id="data-coa-content-template">
        <div class="space-y-6">
            <!-- Header Halaman -->
            <div class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-md">
                <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center">
                    <div>
                        <h2 class="text-xl font-semibold">Master Data - Daftar Akun (COA)</h2>
                        <p class="text-sm text-gray-500 dark:text-gray-400">Chart of Accounts
                            perusahaan.</p>
                    </div>
                    <button id="btn-coa-baru"
                        class="px-4 py-2 mt-4 sm:mt-0 text-sm font-medium rounded-lg bg-indigo-600 text-white hover:bg-indigo-700">
                        <i data-feather="plus" class="w-4 h-4 mr-2 inline-block"></i>Akun Baru
                    </button>
                </div>
            </div>

            <!-- Tabel Data COA -->
            <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md overflow-hidden">
                <div class="overflow-x-auto">
                    <table class="w-full min-w-max">
                        <thead>
                            <tr
                                class="border-b border-gray-200 dark:border-gray-700 text-left text-xs text-gray-500 dark:text-gray-400 uppercase">
                                <th class="py-3 px-4">Kode Akun</th>
                                <th class="py-3 px-4">Nama Akun</th>
                                <th class="py-3 px-4">Kategori</th>
                                <th class="py-3 px-4">Tipe Akun</th>
                                <th class="py-3 px-4">Saldo Normal</th>
                                <th class="py-3 px-4">Aksi</th>
                            </tr>
                        </thead>
                        <tbody id="coa-table-body" class="divide-y divide-gray-100 dark:divide-gray-700">
                            <!-- Aset -->
                            <tr class="bg-gray-50 dark:bg-gray-700 font-medium">
                                <td colspan="6" class="py-2 px-4 text-sm">10000 - Aset</td>
                            </tr>
                            <tr>
                                <td class="py-3 px-4 text-sm font-medium pl-8">10100</td>
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">Kas &
                                    Setara Kas</td>
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">Aset
                                    Lancar</td>
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">Header
                                </td>
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">Debit
                                </td>
                                <td class="py-3 px-4 text-sm space-x-2">
                                    <button
                                        class="btn-edit-coa text-indigo-600 dark:text-indigo-400 hover:text-indigo-800 dark:hover:text-indigo-200 p-1">
                                        <i data-feather="edit-2" class="w-4 h-4"></i>
                                    </button>
                                    <button
                                        class="btn-delete-coa text-red-500 dark:text-red-400 hover:text-red-700 dark:hover:text-red-200 p-1">
                                        <i data-feather="trash-2" class="w-4 h-4"></i>
                                    </button>
                                </td>
                            </tr>
                            <tr>
                                <td class="py-3 px-4 text-sm font-medium pl-8">10200</td>
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">Piutang
                                    Usaha</td>
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">Aset
                                    Lancar</td>
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">Detail
                                </td>
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">Debit
                                </td>
                                <td class="py-3 px-4 text-sm space-x-2">
                                    <button
                                        class="btn-edit-coa text-indigo-600 dark:text-indigo-400 hover:text-indigo-800 dark:hover:text-indigo-200 p-1">
                                        <i data-feather="edit-2" class="w-4 h-4"></i>
                                    </button>
                                    <button
                                        class="btn-delete-coa text-red-500 dark:text-red-400 hover:text-red-700 dark:hover:text-red-200 p-1">
                                        <i data-feather="trash-2" class="w-4 h-4"></i>
                                    </button>
                                </td>
                            </tr>
                            <!-- Pendapatan -->
                            <tr class="bg-gray-50 dark:bg-gray-700 font-medium">
                                <td colspan="6" class="py-2 px-4 text-sm">40000 - Pendapatan</td>
                            </tr>
                            <tr>
                                <td class="py-3 px-4 text-sm font-medium pl-8">40100</td>
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">
                                    Pendapatan Jasa</td>
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">
                                    Pendapatan</td>
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">Detail
                                </td>
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">Kredit
                                </td>
                                <td class="py-3 px-4 text-sm space-x-2">
                                    <button
                                        class="btn-edit-coa text-indigo-600 dark:text-indigo-400 hover:text-indigo-800 dark:hover:text-indigo-200 p-1">
                                        <i data-feather="edit-2" class="w-4 h-4"></i>
                                    </button>
                                    <button
                                        class="btn-delete-coa text-red-500 dark:text-red-400 hover:text-red-700 dark:hover:text-red-200 p-1">
                                        <i data-feather="trash-2" class="w-4 h-4"></i>
                                    </button>
                                </td>
                            </tr>
                            <!-- Biaya -->
                            <tr class="bg-gray-50 dark:bg-gray-700 font-medium">
                                <td colspan="6" class="py-2 px-4 text-sm">50000 - Biaya</td>
                            </tr>
                            <tr>
                                <td class="py-3 px-4 text-sm font-medium pl-8">50100</td>
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">Biaya
                                    Gaji</td>
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">Biaya
                                    Operasional</td>
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">Detail
                                </td>
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">Debit
                                </td>
                                <td class="py-3 px-4 text-sm space-x-2">
                                    <button
                                        class="btn-edit-coa text-indigo-600 dark:text-indigo-400 hover:text-indigo-800 dark:hover:text-indigo-200 p-1">
                                        <i data-feather="edit-2" class="w-4 h-4"></i>
                                    </button>
                                    <button
                                        class="btn-delete-coa text-red-500 dark:text-red-400 hover:text-red-700 dark:hover:text-red-200 p-1">
                                        <i data-feather="trash-2" class="w-4 h-4"></i>
                                    </button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </template>

    <template id="pengaturan-content-template">
        <div class="space-y-6 max-w-2xl mx-auto">
            <!-- Pengaturan Profil -->
            <div class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-md">
                <h2 class="text-xl font-semibold mb-4 border-b pb-3 border-gray-200 dark:border-gray-700">
                    Profil Pengguna</h2>
                <form class="space-y-4">
                    <div class="flex items-center space-x-4">
                        <img class="h-16 w-16 rounded-full object-cover"
                            src="https://placehold.co/100x100/e2e8f0/64748b?text=AP" alt="User avatar">
                        <button type="button" data-toast="Fungsi ini belum tersedia."
                            class="btn-toast px-4 py-2 text-sm font-medium rounded-lg border border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-700">
                            Ubah Foto
                        </button>
                    </div>
                    <div>
                        <label for="nama-lengkap"
                            class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Nama
                            Lengkap</label>
                        <input type="text" id="nama-lengkap" value="Andi Permana"
                            class="w-full text-sm rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500">
                    </div>
                    <div>
                        <label for="email"
                            class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Email</label>
                        <input type="email" id="email" value="admin@unanza.com"
                            class="w-full text-sm rounded-lg border border-gray-300 dark:border-gray-600 bg-gray-100 dark:bg-gray-900"
                            readonly>
                    </div>
                    <div class="text-right pt-2">
                        <!-- (FIX) ID dan type="button" ditambahkan -->
                        <button type="button" id="btn-save-settings"
                            class="px-5 py-2 text-sm font-medium rounded-lg bg-indigo-600 text-white hover:bg-indigo-700">
                            Simpan Perubahan
                        </button>
                    </div>
                </form>
            </div>

            <!-- Pengaturan Tampilan (Tema) -->
            <div class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-md">
                <h2 class="text-xl font-semibold mb-4 border-b pb-3 border-gray-200 dark:border-gray-700">
                    Tampilan</h2>
                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Mode
                        Tampilan</label>
                    <div class="flex space-x-2">
                        <button id="theme-light-btn"
                            class="flex-1 flex items-center justify-center px-4 py-3 rounded-lg border border-gray-300 dark:border-gray-600">
                            <i data-feather="sun" class="w-5 h-5 mr-2"></i>
                            <span>Terang</span>
                        </button>
                        <button id="theme-dark-btn"
                            class="flex-1 flex items-center justify-center px-4 py-3 rounded-lg border border-gray-300 dark:border-gray-600">
                            <i data-feather="moon" class="w-5 h-5 mr-2"></i>
                            <span>Gelap</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </template>

    <!-- (MODIFIKASI) Template Halaman Bantuan (dengan Asisten AI) -->
    <template id="bantuan-content-template">
        <div class="flex flex-col h-full max-w-3xl mx-auto">
            <!-- Header Halaman Bantuan -->
            <div class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-md mb-6 text-center">
                <i data-feather="message-circle" class="w-16 h-16 text-indigo-500 mx-auto mb-4"></i>
                <h2 class="text-2xl font-semibold">Asisten AI Unanza</h2>
                <p class="text-gray-600 dark:text-gray-300 mt-2">Saya di sini untuk membantu Anda
                    menavigasi Unanza. Ajukan pertanyaan apa saja!</p>
            </div>

            <!-- Kontainer Chat -->
            <div
                class="flex-1 bg-white dark:bg-gray-800 p-4 rounded-xl shadow-md flex flex-col overflow-hidden">
                <!-- Area Pesan (Scrollable) -->
                <div id="chat-messages" class="flex-1 space-y-4 overflow-y-auto p-4">
                    <!-- Pesan Selamat Datang -->
                    <div class="flex justify-start">
                        <div class="chat-bubble gemini">
                            Halo! Saya Asisten AI Unanza. Anda bisa bertanya pada saya hal seperti:
                            <ul class="list-disc list-inside mt-2 text-sm">
                                <li>Bagaimana cara membuat faktur?</li>
                                <li>Di mana saya bisa melihat laporan laba rugi?</li>
                                <li>Bagaimana cara mengubah tema menjadi gelap?</li>
                            </ul>
                        </div>
                    </div>
                    <!-- Pesan lain akan ditambahkan oleh JS -->
                </div>

                <!-- Indikator Mengetik (hidden by default) -->
                <div id="typing-indicator" class="p-4 hidden">
                    <div class="chat-bubble gemini inline-block">
                        <div class="typing-indicator">
                            <span></span>
                            <span></span>
                            <span></span>
                        </div>
                    </div>
                </div>

                <!-- Input Chat -->
                <form id="chat-form"
                    class="p-4 border-t border-gray-200 dark:border-gray-700 flex items-center space-x-2">
                    <input type="text" id="chat-input"
                        class="flex-1 pl-4 pr-4 py-2 rounded-lg border border-gray-300 dark:border-gray-700 bg-gray-50 dark:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500"
                        placeholder="Ketik pertanyaan Anda..." autocomplete="off">
                    <button type="submit"
                        class="p-2 rounded-lg bg-indigo-600 text-white hover:bg-indigo-700">
                        <i data-feather="send" class="w-5 h-5"></i>
                    </button>
                </form>
            </div>

            <!-- Kartu Tips & Trik -->
            <div class="mt-6">
                <h3 class="text-lg font-semibold mb-3">Tips & Trik</h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div class="bg-white dark:bg-gray-800 p-4 rounded-xl shadow-md">
                        <i data-feather="search" class="w-6 h-6 text-indigo-500 mb-2"></i>
                        <h4 class="font-semibold mb-1">Pencarian Cepat</h4>
                        <p class="text-sm text-gray-600 dark:text-gray-300">Gunakan bar pencarian di
                            header atas untuk mencari faktur atau pelanggan dengan cepat.</p>
                    </div>
                    <div class="bg-white dark:bg-gray-800 p-4 rounded-xl shadow-md">
                        <i data-feather="moon" class="w-6 h-6 text-indigo-500 mb-2"></i>
                        <h4 class="font-semibold mb-1">Mode Gelap</h4>
                        <p class="text-sm text-gray-600 dark:text-gray-300">Ubah tampilan ke mode
                            gelap kapan saja melalui menu "Pengaturan" > "Tampilan".</p>
                    </div>
                    <div class="bg-white dark:bg-gray-800 p-4 rounded-xl shadow-md">
                        <i data-feather="bar-chart-2" class="w-6 h-6 text-indigo-500 mb-2"></i>
                        <h4 class="font-semibold mb-1">Chart Interaktif</h4>
                        <p class="text-sm text-gray-600 dark:text-gray-300">Arahkan kursor ke chart di
                            dashboard atau laporan untuk melihat detail angka per bulan.</p>
                    </div>
                </div>
            </div>
        </div>
    </template>

    <template id="error-content-template">
        <div class="text-center mt-20">
            <h1 class="text-9xl font-bold text-indigo-600">404</h1>
            <p class="text-2xl font-medium mt-4">Halaman Tidak Ditemukan</p>
            <p class="text-gray-600 dark:text-gray-300 mt-2">Maaf, halaman yang Anda cari tidak ada.
            </p>
            <a href="#dashboard"
                class="sidebar-link mt-6 inline-block px-6 py-3 text-sm font-medium rounded-lg bg-indigo-600 text-white hover:bg-indigo-700">
                Kembali ke Dashboard
            </a>
        </div>
    </template>


    <!-- =================================================================== -->
    <!-- MODAL & NOTIFIKASI -->
    <!-- =================================================================== -->

    <!-- Latar Belakang Modal (Backdrop) -->
    <!-- FIX MOBILE: z-20 (di bawah sidebar mobile z-30) -->
    <div id="modal-backdrop" class="fixed inset-0 bg-black bg-opacity-50 hidden z-20"></div>

    <!-- Modal: Buat Faktur -->
    <!-- z-40 (di atas backdrop z-20 dan sidebar z-30) -->
    <div id="modal-faktur"
        class="fixed inset-0 flex items-center justify-center p-4 z-40 hidden animate-fadeIn">
        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-full max-w-2xl overflow-hidden">
            <form id="modal-faktur-form">
                <!-- Header Modal -->
                <div
                    class="flex justify-between items-center p-5 border-b border-gray-200 dark:border-gray-700">
                    <h3 class="text-lg font-semibold">Buat Faktur Penjualan Baru</h3>
                    <button type="button" data-close-modal="modal-faktur"
                        class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-200">
                        <i data-feather="x" class="w-6 h-6"></i>
                    </button>
                </div>
                <!-- Body Modal -->
                <div class="p-6 space-y-4 max-h-[70vh] overflow-y-auto">
                    <!-- Data Pelanggan -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label for="faktur-pelanggan"
                                class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Pelanggan</label>
                            <select id="faktur-pelanggan" required
                                class="w-full text-sm rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500">
                                <option value="">Pilih Pelanggan</option>
                                <!-- Opsi akan di-render oleh JS dari data pelanggan -->
                            </select>
                        </div>
                        <div>
                            <label for="faktur-email"
                                class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Email</label>
                            <input type="email" id="faktur-email"
                                placeholder="Email pelanggan..."
                                class="w-full text-sm rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500">
                        </div>
                    </div>
                    <!-- Tanggal -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label for="faktur-tanggal"
                                class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Tgl.
                                Terbit</label>
                            <input type="date" id="faktur-tanggal"
                                value="2024-10-26" required
                                class="w-full text-sm rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500">
                        </div>
                        <div>
                            <label for="faktur-jatuh-tempo"
                                class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Tgl.
                                Jatuh Tempo</label>
                            <input type="date" id="faktur-jatuh-tempo"
                                value="2024-11-10" required
                                class="w-full text-sm rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500">
                        </div>
                    </div>
                    <hr class="border-gray-200 dark:border-gray-700">
                    <!-- Kalkulasi Total -->
                    <div>
                        <label for="faktur-dpp"
                            class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">DPP
                            (Dasar Pengenaan Pajak)</label>
                        <input type="number" id="faktur-dpp" placeholder="0" required
                            class="w-full text-sm rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500">
                    </div>
                    <div>
                        <label for="faktur-ppn"
                            class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">PPN
                            11%</label>
                        <input type="number" id="faktur-ppn" placeholder="0" readonly
                            class="w-full text-sm rounded-lg border border-gray-300 dark:border-gray-600 bg-gray-100 dark:bg-gray-900">
                    </div>
                    <div>
                        <label for="faktur-total"
                            class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Total
                            Tagihan</label>
                        <input type="number" id="faktur-total" placeholder="0"
                            readonly
                            class="w-full text-sm rounded-lg border border-gray-300 dark:border-gray-600 bg-gray-100 dark:bg-gray-900 font-bold">
                    </div>
                    <!-- (BARU) Pesan Error Validasi -->
                    <div id="faktur-error-message" class="text-sm text-red-500 hidden"></div>
                </div>
                <!-- Footer Modal -->
                <div
                    class="flex justify-end items-center p-5 space-x-3 bg-gray-50 dark:bg-gray-900 border-t border-gray-200 dark:border-gray-700">
                    <button type="button" data-close-modal="modal-faktur"
                        class="px-4 py-2 text-sm font-medium rounded-lg border border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700">
                        Batal
                    </button>
                    <button type="submit"
                        class="px-4 py-2 text-sm font-medium rounded-lg bg-indigo-600 text-white hover:bg-indigo-700">
                        Simpan Faktur
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal: Biaya Baru -->
    <div id="modal-biaya"
        class="fixed inset-0 flex items-center justify-center p-4 z-40 hidden animate-fadeIn">
        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-full max-w-lg overflow-hidden">
            <form id="modal-biaya-form">
                <!-- Header Modal -->
                <div
                    class="flex justify-between items-center p-5 border-b border-gray-200 dark:border-gray-700">
                    <h3 class="text-lg font-semibold">Catat Biaya Baru</h3>
                    <button type="button" data-close-modal="modal-biaya"
                        class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-200">
                        <i data-feather="x" class="w-6 h-6"></i>
                    </button>
                </div>
                <!-- Body Modal -->
                <div class="p-6 space-y-4">
                    <div>
                        <label for="biaya-akun"
                            class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Akun
                            Biaya</label>
                        <select id="biaya-akun" required
                            class="w-full text-sm rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500">
                            <option value="">Pilih Akun Biaya</option>
                            <option value="50100">(50100) Biaya Gaji</option>
                            <option value="50200">(50200) Biaya Marketing</option>
                            <option value="50300">(50300) Biaya Sewa</option>
                        </select>
                    </div>
                    <div>
                        <label for="biaya-nominal"
                            class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Nominal</label>
                        <input type="number" id="biaya-nominal" placeholder="0" required
                            class="w-full text-sm rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500">
                    </div>
                    <div>
                        <label for="biaya-deskripsi"
                            class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Deskripsi</label>
                        <textarea id="biaya-deskripsi" rows="3"
                            placeholder="Contoh: Biaya Iklan Google Ads November"
                            class="w-full text-sm rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500"></textarea>
                    </div>
                    <!-- (BARU) Pesan Error Validasi -->
                    <div id="biaya-error-message" class="text-sm text-red-500 hidden"></div>
                </div>
                <!-- Footer Modal -->
                <div
                    class="flex justify-end items-center p-5 space-x-3 bg-gray-50 dark:bg-gray-900 border-t border-gray-200 dark:border-gray-700">
                    <button type="button" data-close-modal="modal-biaya"
                        class="px-4 py-2 text-sm font-medium rounded-lg border border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700">
                        Batal
                    </button>
                    <button type="submit"
                        class="px-4 py-2 text-sm font-medium rounded-lg bg-indigo-600 text-white hover:bg-indigo-700">
                        Simpan Biaya
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- (BARU) Modal CRUD Master Data (Form Pelanggan/Supplier/COA) -->
    <div id="modal-pelanggan-form"
        class="fixed inset-0 flex items-center justify-center p-4 z-40 hidden animate-fadeIn">
        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-full max-w-lg overflow-hidden">
            <form id="pelanggan-form">
                <!-- Header Modal -->
                <div
                    class="flex justify-between items-center p-5 border-b border-gray-200 dark:border-gray-700">
                    <h3 id="modal-pelanggan-title" class="text-lg font-semibold">Pelanggan Baru</h3>
                    <button type="button" data-close-modal="modal-pelanggan-form"
                        class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-200">
                        <i data-feather="x" class="w-6 h-6"></i>
                    </button>
                </div>
                <!-- Body Modal -->
                <div class="p-6 space-y-4">
                    <!-- Hidden input untuk menyimpan ID saat Edit -->
                    <input type="hidden" id="pelanggan-id" value="">
                    <div>
                        <label for="pelanggan-nama"
                            class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Nama
                            Pelanggan</label>
                        <input type="text" id="pelanggan-nama" required
                            class="w-full text-sm rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500">
                    </div>
                    <div>
                        <label for="pelanggan-email"
                            class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Email</label>
                        <input type="email" id="pelanggan-email" required
                            class="w-full text-sm rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500">
                    </div>
                    <div>
                        <label for="pelanggan-telepon"
                            class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Telepon</label>
                        <input type="tel" id="pelanggan-telepon"
                            class="w-full text-sm rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500">
                    </div>
                    <!-- (BARU) Pesan Error Validasi -->
                    <div id="pelanggan-error-message" class="text-sm text-red-500 hidden"></div>
                </div>
                <!-- Footer Modal -->
                <div
                    class="flex justify-end items-center p-5 space-x-3 bg-gray-50 dark:bg-gray-900 border-t border-gray-200 dark:border-gray-700">
                    <button type="button" data-close-modal="modal-pelanggan-form"
                        class="px-4 py-2 text-sm font-medium rounded-lg border border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700">
                        Batal
                    </button>
                    <button type="submit"
                        class="px-4 py-2 text-sm font-medium rounded-lg bg-indigo-600 text-white hover:bg-indigo-700">
                        Simpan
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- (BARU) Modal Konfirmasi Hapus -->
    <div id="modal-konfirmasi-hapus"
        class="fixed inset-0 flex items-center justify-center p-4 z-40 hidden animate-fadeIn">
        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-full max-w-md overflow-hidden">
            <!-- Header Modal -->
            <div
                class="flex justify-between items-center p-5 border-b border-gray-200 dark:border-gray-700">
                <h3 id="modal-hapus-title" class="text-lg font-semibold">Konfirmasi Hapus</h3>
                <button type="button" data-close-modal="modal-konfirmasi-hapus"
                    class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-200">
                    <i data-feather="x" class="w-6 h-6"></i>
                </button>
            </div>
            <!-- Body Modal -->
            <div class="p-6 space-y-4">
                <p id="modal-hapus-message">Apakah Anda yakin ingin menghapus data ini? Tindakan ini
                    tidak dapat dibatalkan.</p>
                <!-- Hidden input untuk menyimpan ID item yang akan dihapus -->
                <input type="hidden" id="hapus-item-id" value="">
                <input type="hidden" id="hapus-item-type" value="">
                <!-- 'pelanggan', 'supplier', 'coa' -->
            </div>
            <!-- Footer Modal -->
            <div
                class="flex justify-end items-center p-5 space-x-3 bg-gray-50 dark:bg-gray-900 border-t border-gray-200 dark:border-gray-700">
                <button type="button" data-close-modal="modal-konfirmasi-hapus"
                    class="px-4 py-2 text-sm font-medium rounded-lg border border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700">
                    Batal
                </button>
                <button id="btn-konfirmasi-hapus" type="button"
                    class="px-4 py-2 text-sm font-medium rounded-lg bg-red-600 text-white hover:bg-red-700">
                    Ya, Hapus
                </button>
            </div>
        </div>
    </div>


    <!-- Notifikasi Toast -->
    <div id="toast-notification"
        class="fixed top-5 right-5 w-auto max-w-sm p-4 rounded-lg shadow-lg text-white z-50 transition-all duration-300 transform translate-x-10 opacity-0 hidden">
        <div class="flex items-center">
            <i id="toast-icon" data-feather="check-circle" class="w-5 h-5 mr-3"></i>
            <p id="toast-message" class="text-sm font-medium">Faktur berhasil disimpan!</p>
        </div>
    </div>


    <!-- =================================================================== -->
    <!-- SCRIPT UTAMA APLIKASI -->
    <!-- =================================================================== -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {

            // --- Inisialisasi Ikon ---
            feather.replace();

            // --- Variabel Global ---
            const mainContent = document.getElementById('mainContent');
            const pageTitle = document.getElementById('page-title');
            const breadcrumbs = document.getElementById('breadcrumbs');
            const allLinks = document.querySelectorAll('.sidebar-link, .drill-down');
            const sidebar = document.getElementById('sidebar'); // (FIX)
            const mobileMenuButton = document.getElementById('mobile-menu-button'); // (FIX)

            // --- Variabel Modal & Toast ---
            const modalBackdrop = document.getElementById('modal-backdrop');
            const modalFaktur = document.getElementById('modal-faktur');
            const modalBiaya = document.getElementById('modal-biaya');
            const modalPelangganForm = document.getElementById('modal-pelanggan-form'); // (BARU)
            const modalKonfirmasiHapus = document.getElementById('modal-konfirmasi-hapus'); // (BARU)
            const toast = document.getElementById('toast-notification');
            const toastMessage = document.getElementById('toast-message');
            const toastIcon = document.getElementById('toast-icon'); // (BARU)

            // --- (BARU) Variabel Header Interaktif ---
            const notificationButton = document.getElementById('notification-button');
            const notificationDropdown = document.getElementById('notification-dropdown');
            const profileButton = document.getElementById('profile-button');
            const profileDropdown = document.getElementById('profile-dropdown');
            const headerSearchInput = document.getElementById('header-search-input');
            const searchResultsDropdown = document.getElementById('search-results-dropdown');
            const searchResultsList = document.getElementById('search-results-list');

            // (BARU) Data dummy untuk pencarian header
            const dummySearchData = [
                { title: 'Faktur: INV-2024-001', href: '#faktur-penjualan' },
                { title: 'Faktur: INV-2024-002', href: '#faktur-penjualan' },
                { title: 'Pelanggan: PT Jaya Abadi', href: '#data-pelanggan' },
                { title: 'Pelanggan: CV Sinar Terang', href: '#data-pelanggan' },
                { title: 'Laporan: Laba Rugi', href: '#laporan-labarugi' },
                { title: 'Supplier: PT Office Sukses', href: '#data-supplier' },
            ];

            // --- Variabel Instance Grafik (untuk di-destroy) ---
            let financialChartInstance = null;
            let pnlChartInstance = null;
            let neracaChartInstance = null;
            let cashFlowChartInstance = null;
            let costCenterChartInstance = null;

            // --- (BARU) Database In-Memory (Simulasi State) ---
            // Ini akan mengatasi Kritik #1 (Hilangnya data saat navigasi)
            const db = {
                pelanggan: [
                    { id: 'CUS-001', nama: 'PT Maju Mundur', email: 'finance@majumundur.com', telepon: '021-555-1234', piutang: 0 },
                    { id: 'CUS-002', nama: 'PT Jaya Abadi', email: 'ap@jayaabadi.co.id', telepon: '021-555-5678', piutang: 30000000 },
                    { id: 'CUS-003', nama: 'CV Sinar Terang', email: 'kontak@sinarterang.com', telepon: '031-777-9012', piutang: 45000000 },
                ],
                fakturPenjualan: [
                    { id: 'INV-2024-001', pelanggan: 'PT Maju Mundur', tglTerbit: '10 Okt 2024', tglJatuhTempo: '25 Okt 2024', total: 15000000, status: 'Lunas' },
                    { id: 'INV-2024-002', pelanggan: 'PT Jaya Abadi', tglTerbit: '24 Okt 2024', tglJatuhTempo: '08 Nov 2024', total: 30000000, status: 'Tertunda' },
                    { id: 'INV-2024-003', pelanggan: 'CV Sinar Terang', tglTerbit: '15 Sep 2024', tglJatuhTempo: '30 Sep 2024', total: 45000000, status: 'Jatuh Tempo' },
                ]
                // ... data supplier dan coa bisa ditambahkan di sini
            };

            // --- Konfigurasi Halaman ---
            const pageConfig = {
                'dashboard': {
                    title: 'Dashboard',
                    breadcrumb: 'Utama / Dashboard'
                },
                'laporan-labarugi': {
                    title: 'Laporan Laba Rugi',
                    breadcrumb: 'Laporan / Laporan Laba Rugi'
                },
                'laporan-neraca': {
                    title: 'Laporan Neraca',
                    breadcrumb: 'Laporan / Laporan Neraca'
                },
                'laporan-aruskas': {
                    title: 'Laporan Arus Kas',
                    breadcrumb: 'Laporan / Laporan Arus Kas'
                },
                'laporan-biaya': {
                    title: 'Laporan Biaya',
                    breadcrumb: 'Laporan / Laporan Biaya'
                },
                // (MODIFIKASI) Halaman baru Operasional
                'faktur-penjualan': {
                    title: 'Faktur Penjualan',
                    breadcrumb: 'Operasional / Penjualan / Faktur Penjualan'
                },
                'pesanan-penjualan': {
                    title: 'Pesanan Penjualan',
                    breadcrumb: 'Operasional / Penjualan / Pesanan Penjualan'
                },
                'faktur-pembelian': {
                    title: 'Faktur Pembelian',
                    breadcrumb: 'Operasional / Pembelian / Faktur Pembelian'
                },
                'pesanan-pembelian': {
                    title: 'Pesanan Pembelian',
                    breadcrumb: 'Operasional / Pembelian / Pesanan Pembelian'
                },
                'buku-besar': {
                    title: 'Buku Besar',
                    breadcrumb: 'Operasional / Buku Besar'
                },
                'data-pelanggan': {
                    title: 'Data Pelanggan',
                    breadcrumb: 'Master Data / Data Pelanggan'
                },
                'data-supplier': {
                    title: 'Data Supplier',
                    breadcrumb: 'Master Data / Data Supplier'
                },
                'data-coa': {
                    title: 'Daftar Akun (COA)',
                    breadcrumb: 'Master Data / Daftar Akun (COA)'
                },
                'pengaturan': {
                    title: 'Pengaturan',
                    breadcrumb: 'Lainnya / Pengaturan'
                },
                'bantuan': {
                    title: 'Bantuan',
                    breadcrumb: 'Lainnya / Bantuan'
                },
                'error': {
                    title: 'Error',
                    breadcrumb: 'Error'
                }
            };

            // --- Konfigurasi Dark Mode ---
            const applyTheme = (theme) => {
                if (theme === 'dark') {
                    document.documentElement.classList.add('dark');
                    localStorage.setItem('theme', 'dark');
                } else {
                    document.documentElement.classList.remove('dark');
                    localStorage.setItem('theme', 'light');
                }
            };

            // Cek tema saat memuat
            const savedTheme = localStorage.getItem('theme');
            const systemPrefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
            applyTheme(savedTheme || (systemPrefersDark ? 'dark' : 'light'));


            // --- Logika Menu Drill-down ---
            document.querySelectorAll('.drill-down > a').forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const parent = link.parentElement;
                    const submenu = parent.querySelector('.submenu');
                    // FIX: Query untuk SVG yang sudah di-replace oleh feather.replace()
                    const icon = link.querySelector('svg.feather-chevron-right');

                    if (!submenu || !icon) return; // Penjagaan jika elemen tidak ditemukan

                    if (parent.classList.contains('open')) {
                        parent.classList.remove('open');
                        submenu.style.maxHeight = null;
                        icon.style.transform = 'rotate(0deg)';
                    } else {
                        // Tutup semua menu lain
                        document.querySelectorAll('.drill-down.open').forEach(openMenu => {
                            if (openMenu !== parent) { // Jangan tutup diri sendiri jika sudah terbuka
                                openMenu.classList.remove('open');
                                const openSubmenu = openMenu.querySelector('.submenu');
                                const openIcon = openMenu.querySelector('svg.feather-chevron-right');
                                if (openSubmenu) openSubmenu.style.maxHeight = null;
                                if (openIcon) openIcon.style.transform = 'rotate(0deg)';
                            }
                        });

                        // Buka menu ini
                        parent.classList.add('open');
                        submenu.style.maxHeight = submenu.scrollHeight + 'px';
                        icon.style.transform = 'rotate(90deg)';
                    }
                });
            });

            // --- (FIX) Logika Menu Mobile ---
            if (mobileMenuButton && sidebar && modalBackdrop) {
                mobileMenuButton.addEventListener('click', (e) => {
                    e.stopPropagation(); // Hentikan event agar tidak ditangkap backdrop
                    sidebar.classList.remove('-translate-x-full'); // Tampilkan sidebar
                    modalBackdrop.classList.remove('hidden'); // Tampilkan backdrop
                });
            }

            // --- (MODIFIKASI) Logika Backdrop Global & Klik di Luar ---
            modalBackdrop.addEventListener('click', closeAllModalsAndSidebars);

            window.addEventListener('click', (e) => {
                // Cek Notifikasi
                if (notificationButton && notificationDropdown && !notificationButton.contains(e.target) && !notificationDropdown.contains(e.target)) {
                    notificationDropdown.classList.add('hidden');
                }
                // Cek Profil
                if (profileButton && profileDropdown && !profileButton.contains(e.target) && !profileDropdown.contains(e.target)) {
                    profileDropdown.classList.add('hidden');
                }
            });

            // (BARU) Fungsi helper untuk menutup semua
            function closeAllModalsAndSidebars() {
                closeModal(modalFaktur);
                closeModal(modalBiaya);
                closeModal(modalPelangganForm);
                closeModal(modalKonfirmasiHapus);

                if (sidebar) {
                    sidebar.classList.add('-translate-x-full');
                }
                modalBackdrop.classList.add('hidden');
            }


            // --- Fungsi Helper ---

            // Konversi string 'Rp 1.234.567' atau 'Rp 500 Jt' ke angka
            function parseCurrency(text) {
                if (typeof text === 'number') return text;
                if (!text) return 0;
                let numStr = text.replace(/Rp/g, '').replace(/\./g, '').replace(/,/g, '.').trim();
                if (numStr.includes('Jt')) {
                    return parseFloat(numStr.replace('Jt', '')) * 1000000;
                }
                if (numStr.includes('M')) {
                    return parseFloat(numStr.replace('M', '')) * 1000000000;
                }
                return parseFloat(numStr) || 0;
            }

            // Format angka ke Rupiah
            function formatCurrency(num) {
                if (isNaN(num)) return 'Rp 0';
                return new Intl.NumberFormat('id-ID', {
                    style: 'currency',
                    currency: 'IDR',
                    minimumFractionDigits: 0,
                    maximumFractionDigits: 0
                }).format(num);
            }

            // Konversi 'DD Mmm YYYY' (cth: '25 Okt 2024') ke Objek Date
            function parseDate(dateString) {
                const monthMap = {
                    'Jan': 0, 'Feb': 1, 'Mar': 2, 'Apr': 3, 'Mei': 4, 'Jun': 5,
                    'Jul': 6, 'Agu': 7, 'Sep': 8, 'Okt': 9, 'Nov': 10, 'Des': 11
                };
                const parts = dateString.split(' ');
                if (parts.length === 3) {
                    const day = parseInt(parts[0], 10);
                    const month = monthMap[parts[1]];
                    const year = parseInt(parts[2], 10);
                    if (!isNaN(day) && month !== undefined && !isNaN(year)) {
                        return new Date(year, month, day);
                    }
                }
                return new Date(0); // Invalid date
            }

            // Konversi YYYY-MM-DD ke DD Mmm YYYY
            function formatDate(dateString) {
                if (!dateString) return '';
                const date = new Date(dateString);
                const options = { day: '2-digit', month: 'short', year: 'numeric' };
                return date.toLocaleDateString('id-ID', options).replace(/\./g, '');
            }


            // --- Fungsi Notifikasi Toast ---
            function showToast(message, success = true) {
                toastMessage.textContent = message;
                // Ganti ikon berdasarkan status
                const iconName = success ? 'check-circle' : 'alert-circle';
                toastIcon.setAttribute('data-feather', iconName);
                feather.replace({ width: 20, height: 20 }); // Refresh ikonnya

                toast.classList.remove('hidden', 'translate-x-10', 'opacity-0', 'bg-green-500', 'bg-red-500');
                toast.classList.add(success ? 'bg-green-500' : 'bg-red-500');

                // Sembunyikan setelah 3 detik
                setTimeout(() => {
                    toast.classList.add('translate-x-10', 'opacity-0');
                    setTimeout(() => toast.classList.add('hidden'), 300); // Tunggu transisi selesai
                }, 3000);
            }

            // --- Fungsi Render Grafik ---
            function renderFinancialChart() {
                if (financialChartInstance) financialChartInstance.destroy();
                const ctx = document.getElementById('financialChart')?.getContext('2d');
                if (!ctx) return;

                financialChartInstance = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: ['Mei', 'Jun', 'Jul', 'Agu', 'Sep', 'Okt'],
                        datasets: [{
                            label: 'Kas Masuk',
                            data: [150, 200, 300, 250, 400, 500],
                            borderColor: 'rgba(79, 70, 229, 1)', // indigo-600
                            backgroundColor: 'rgba(79, 70, 229, 0.1)',
                            tension: 0.3,
                            fill: true,
                        }, {
                            label: 'Kas Keluar',
                            data: [100, 180, 250, 200, 300, 250],
                            borderColor: 'rgba(239, 68, 68, 1)', // red-500
                            backgroundColor: 'rgba(239, 68, 68, 0.1)',
                            tension: 0.3,
                            fill: true,
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true,
                                ticks: {
                                    callback: (val) => `Rp ${val} Jt`
                                }
                            }
                        },
                        plugins: {
                            tooltip: {
                                callbacks: {
                                    label: (ctx) => ` ${ctx.dataset.label}: Rp ${ctx.raw} Jt`
                                }
                            }
                        }
                    }
                });
            }

            function renderPnlChart() {
                if (pnlChartInstance) pnlChartInstance.destroy();
                const ctx = document.getElementById('pnlChart')?.getContext('2d');
                if (!ctx) return;

                pnlChartInstance = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: ['Q1 2024', 'Q2 2024', 'Q3 2024', 'Q4 2024 (Est.)'],
                        datasets: [{
                            label: 'Pendapatan',
                            data: [300, 350, 400, 450],
                            backgroundColor: 'rgba(16, 185, 129, 0.7)', // green-500
                        }, {
                            label: 'Biaya',
                            data: [200, 220, 250, 280],
                            backgroundColor: 'rgba(239, 68, 68, 0.7)', // red-500
                        }, {
                            label: 'Laba Bersih',
                            data: [100, 130, 150, 170],
                            backgroundColor: 'rgba(79, 70, 229, 0.7)', // indigo-600
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            x: {
                                stacked: false
                            },
                            y: {
                                stacked: false,
                                ticks: {
                                    callback: (val) => `Rp ${val} Jt`
                                }
                            }
                        },
                        plugins: {
                            tooltip: {
                                callbacks: {
                                    label: (ctx) => ` ${ctx.dataset.label}: Rp ${ctx.raw} Jt`
                                }
                            }
                        }
                    }
                });
            }

            function renderNeracaChart() {
                if (neracaChartInstance) neracaChartInstance.destroy();
                const ctx = document.getElementById('neracaChart')?.getContext('2d');
                if (!ctx) return;

                neracaChartInstance = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: ['Struktur Modal (Jt)'],
                        datasets: [
                            // Grup Aset
                            {
                                label: 'Aset Lancar',
                                data: [475],
                                backgroundColor: '#34d399', // green-400
                                stack: 'Aset'
                            }, {
                                label: 'Aset Tetap',
                                data: [400],
                                backgroundColor: '#059669', // green-700
                                stack: 'Aset'
                            },
                            // Grup Liabilitas & Ekuitas
                            {
                                label: 'Liabilitas',
                                data: [275],
                                backgroundColor: '#f87171', // red-400
                                stack: 'LiabilitasEkuitas'
                            }, {
                                label: 'Ekuitas',
                                data: [600],
                                backgroundColor: '#b91c1c', // red-800
                                stack: 'LiabilitasEkuitas'
                            }
                        ]
                    },
                    options: {
                        indexAxis: 'y', // Membuatnya horizontal
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            x: {
                                stacked: true,
                                ticks: {
                                    callback: (val) => `Rp ${val} Jt`
                                }
                            },
                            y: {
                                stacked: true
                            }
                        },
                        plugins: {
                            tooltip: {
                                callbacks: {
                                    label: (ctx) => ` ${ctx.dataset.label}: Rp ${ctx.raw} Jt`
                                }
                            }
                        }
                    }
                });
            }

            // (FIX) Fungsi Render Grafik Arus Kas (Waterfall)
            function renderCashFlowChart() {
                if (cashFlowChartInstance) cashFlowChartInstance.destroy();
                const ctx = document.getElementById('cashFlowChart')?.getContext('2d');
                if (!ctx) return;

                // Implementasi Waterfall Chart menggunakan floating bar
                const labels = ['Saldo Awal', 'Operasi', 'Investasi', 'Pendanaan', 'Saldo Akhir'];
                const data = [];
                const colors = [];
                let saldo = 0;

                // 1. Saldo Awal (Kita tentukan 100 Jt, sesuai Laporan Detail)
                data.push([saldo, 100]);
                colors.push('#3b82f6'); // Biru (Netral)
                saldo = 100;

                // 2. Operasi (+500 Jt, sesuai Laporan Detail)
                data.push([saldo, saldo + 500]); // [100, 600]
                colors.push('#22c55e'); // Hijau (Positif)
                saldo += 500; // saldo = 600

                // 3. Investasi (-250 Jt, sesuai Laporan Detail)
                data.push([saldo, saldo - 250]); // [600, 350]
                colors.push('#ef4444'); // Merah (Negatif)
                saldo -= 250; // saldo = 350

                // 4. Pendanaan (+50 Jt, sesuai Laporan Detail)
                data.push([saldo, saldo + 50]); // [350, 400]
                colors.push('#22c55e'); // Hijau (Positif)
                saldo += 50; // saldo = 400

                // 5. Saldo Akhir (Hasilnya harus 400 Jt)
                data.push([0, saldo]); // [0, 400]
                colors.push('#3b82f6'); // Biru (Netral)

                cashFlowChartInstance = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: 'Pergerakan Kas (Jt)',
                            data: data,
                            backgroundColor: colors,
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: false // Sembunyikan legenda
                            },
                            tooltip: {
                                callbacks: {
                                    label: (ctx) => {
                                        const label = ctx.label;
                                        const val = ctx.raw; // val adalah [start, end]
                                        const change = val[1] - val[0];

                                        if (label === 'Saldo Awal') {
                                            return `Saldo Awal: Rp ${val[1]} Jt`;
                                        }
                                        if (label === 'Saldo Akhir') {
                                            return `Saldo Akhir: Rp ${val[1]} Jt`;
                                        }
                                        return `${label}: Rp ${change > 0 ? '+' : ''}${change} Jt`;
                                    }
                                }
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                ticks: {
                                    callback: (val) => `Rp ${val} Jt`
                                }
                            }
                        }
                    }
                });
            }


            // Fungsi Render Grafik Laporan Biaya
            function renderCostCenterChart() {
                if (costCenterChartInstance) costCenterChartInstance.destroy();
                const ctx = document.getElementById('costCenterChart')?.getContext('2d');
                if (!ctx) return;

                costCenterChartInstance = new Chart(ctx, {
                    type: 'doughnut',
                    data: {
                        labels: ['Gaji & Tunjangan (50%)', 'Marketing & Iklan (20%)', 'Sewa & Utilitas (15%)', 'Lainnya (15%)'],
                        datasets: [{
                            label: 'Alokasi Biaya',
                            // Total Biaya 450 Jt
                            data: [225, 90, 67.5, 67.5], // Data dalam Juta Rp
                            backgroundColor: ['#4f46e5', '#10b981', '#f59e0b', '#ef4444'],
                            hoverOffset: 4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    padding: 15,
                                    font: {
                                        size: 12
                                    }
                                }
                            },
                            tooltip: {
                                callbacks: {
                                    label: (ctx) => ` ${ctx.label}: Rp ${ctx.raw} Jt`
                                }
                            }
                        }
                    }
                });
            }


            // --- Fungsi Navigasi & UI ---
            function navigateTo(pageId) {
                // Ambil template
                // (MODIFIKASI) Ganti 'faktur' ke 'faktur-penjualan'
                const templateId = `${pageId}-content-template` || 'faktur-penjualan-content-template';
                const template = document.getElementById(templateId) || document.getElementById('error-content-template');

                // Ganti konten
                mainContent.innerHTML = template.innerHTML;

                // Perbarui Judul & Breadcrumbs
                const config = pageConfig[pageId] || pageConfig['error'];
                pageTitle.textContent = config.title;
                breadcrumbs.textContent = config.breadcrumb;

                // Perbarui status 'active' di sidebar
                updateActiveLink(pageId);

                // Inisialisasi ikon untuk konten baru
                feather.replace();

                // Hancurkan grafik lama (jika ada) sebelum render baru
                if (financialChartInstance) financialChartInstance.destroy();
                if (pnlChartInstance) pnlChartInstance.destroy();
                if (neracaChartInstance) neracaChartInstance.destroy();
                if (cashFlowChartInstance) cashFlowChartInstance.destroy();
                if (costCenterChartInstance) costCenterChartInstance.destroy();

                // Render grafik/data spesifik untuk halaman
                if (pageId === 'dashboard') {
                    renderFinancialChart();
                    addDashboardListeners(); // (MODIFIKASI)
                }
                if (pageId === 'laporan-labarugi') renderPnlChart();
                if (pageId === 'laporan-neraca') renderNeracaChart();
                if (pageId === 'laporan-aruskas') renderCashFlowChart();
                if (pageId === 'laporan-biaya') renderCostCenterChart();
                if (pageId === 'faktur-penjualan') setupFakturPenjualanPage(); // (MODIFIKASI)
                if (pageId === 'buku-besar') setupTransactionsTable();
                if (pageId === 'pengaturan') setupThemeToggles();
                if (pageId === 'bantuan') setupBantuanPage(); // (BARU)
                if (pageId === 'data-pelanggan') setupDataPelangganPage(); // (BARU)
                
                // (BARU) Setup untuk halaman baru (meskipun masih placeholder)
                if (pageId === 'data-supplier') setupDataSupplierPage();
                if (pageId === 'data-coa') setupDataCoaPage();
                if (pageId === 'pesanan-penjualan') setupPesananPenjualanPage();
                if (pageId === 'pesanan-pembelian') setupPesananPembelianPage();
                if (pageId === 'faktur-pembelian') setupFakturPembelianPage();

                // (BARU) Tambahkan listener untuk tombol-tombol toast
                addToastListeners();
            }

            // Memperbarui link aktif di sidebar
            function updateActiveLink(pageId) {
                allLinks.forEach(link => {
                    const href = link.getAttribute('href');

                    if (link.classList.contains('drill-down')) {
                        // Cek apakah ada submenu yg aktif
                        const hasActiveChild = link.querySelector(`.sidebar-link[href="#${pageId}"]`);
                        if (hasActiveChild) {
                            link.classList.add('active'); // tandai menu drilldown
                            // Buka menu jika belum terbuka
                            if (!link.classList.contains('open')) {
                                const anchorTag = link.querySelector('a');
                                if (anchorTag) anchorTag.click(); // Klik dengan aman
                            }
                        } else {
                            link.classList.remove('active');
                        }
                    } else if (href === `#${pageId}`) {
                        link.classList.add('active');
                    } else {
                        link.classList.remove('active');
                    }
                });
            }

            // --- Fungsi Inisialisasi Halaman Spesifik ---

            function setupThemeToggles() {
                // Perbarui UI tombol berdasarkan tema saat ini
                const updateButtonState = () => {
                    const isDark = document.documentElement.classList.contains('dark');
                    const lightBtn = document.getElementById('theme-light-btn');
                    const darkBtn = document.getElementById('theme-dark-btn');

                    if (lightBtn && darkBtn) {
                        if (isDark) {
                            darkBtn.classList.add('bg-indigo-600', 'text-white');
                            lightBtn.classList.remove('bg-indigo-600', 'text-white');
                        } else {
                            lightBtn.classList.add('bg-indigo-600', 'text-white');
                            darkBtn.classList.remove('bg-indigo-600', 'text-white');
                        }
                    }
                };

                document.getElementById('theme-light-btn')?.addEventListener('click', () => {
                    applyTheme('light');
                    updateButtonState();
                });
                document.getElementById('theme-dark-btn')?.addEventListener('click', () => {
                    applyTheme('dark');
                    updateButtonState();
                });
                
                // (FIX) Tambahkan listener untuk tombol Simpan Pengaturan
                document.getElementById('btn-save-settings')?.addEventListener('click', () => {
                    // Di aplikasi nyata, ini akan mengirim form
                    showToast('Pengaturan berhasil disimpan!');
                });

                updateButtonState(); // Set status awal saat halaman dimuat
            }
            
            // (BARU) Listener untuk Halaman Bantuan
            function setupBantuanPage() {
                const chatForm = document.getElementById('chat-form');
                const chatInput = document.getElementById('chat-input');
                const chatMessages = document.getElementById('chat-messages');
                const typingIndicator = document.getElementById('typing-indicator');

                if (!chatForm || !chatInput || !chatMessages || !typingIndicator) return;
                
                // Fungsi untuk menambahkan pesan ke UI
                const addMessage = (message, sender) => {
                    const bubble = document.createElement('div');
                    bubble.classList.add('flex', sender === 'user' ? 'justify-end' : 'justify-start');
                    bubble.innerHTML = `<div class="chat-bubble ${sender}">${message}</div>`;
                    chatMessages.appendChild(bubble);
                    chatMessages.scrollTop = chatMessages.scrollHeight; // Auto-scroll ke bawah
                };
                
                // Fungsi simulasi respons Gemini
                const getGeminiResponse = (text) => {
                    const lowerText = text.toLowerCase();
                    if (lowerText.includes('faktur')) {
                        return 'Anda dapat membuat faktur baru dengan menavigasi ke menu "Operasional" > "Penjualan" > "Faktur Penjualan", lalu klik tombol "Buat Faktur Baru". <br><br> Apakah ada lagi yang bisa saya bantu?';
                    }
                    if (lowerText.includes('laporan') || lowerText.includes('laba rugi')) {
                        return 'Semua laporan keuangan (Laba Rugi, Neraca, Arus Kas) dapat diakses melalui menu "Laporan" di sidebar. Klik menu tersebut untuk melihat submenu-nya.';
                    }
                    if (lowerText.includes('tema') || lowerText.includes('gelap') || lowerText.includes('dark mode')) {
                        return 'Tentu! Anda bisa mengubah tema menjadi gelap atau terang di menu "Lainnya" > "Pengaturan" > "Tampilan".';
                    }
                    if (lowerText.includes('pelanggan') || lowerText.includes('crud')) {
                        return 'Data pelanggan dapat dikelola di menu "Master Data" > "Data Pelanggan". Anda dapat Menambah, Mengedit, atau Menghapus data pelanggan di sana.';
                    }
                    return 'Maaf, saya belum mengerti pertanyaan itu. Saya masih dalam tahap pengembangan. Anda bisa mencoba bertanya tentang faktur, laporan, atau tema.';
                };

                chatForm.addEventListener('submit', (e) => {
                    e.preventDefault();
                    const userInput = chatInput.value.trim();
                    if (userInput === '') return;

                    addMessage(userInput, 'user');
                    chatInput.value = '';
                    
                    // Tampilkan indikator mengetik
                    typingIndicator.classList.remove('hidden');
                    
                    // Simulasi delay respons AI
                    setTimeout(() => {
                        const response = getGeminiResponse(userInput);
                        typingIndicator.classList.add('hidden');
                        addMessage(response, 'gemini');
                    }, 1500);
                });
            }
            
            // (BARU) Listener untuk tombol-tombol kosmetik
            function addToastListeners() {
                document.querySelectorAll('.btn-toast').forEach(button => {
                    button.addEventListener('click', (e) => {
                        e.preventDefault();
                        const message = button.dataset.toast || 'Fungsi ini belum tersedia.';
                        showToast(message, false); // Tampilkan sebagai notifikasi 'gagal'
                    });
                });
            }

            // --- Fungsi Modal ---
            function openModal(modal) {
                if (modal) {
                    modalBackdrop.classList.remove('hidden');
                    modal.classList.remove('hidden');
                }
            }

            function closeModal(modal) {
                if (modal) {
                    modal.classList.add('hidden');
                    
                    // Cek apakah ada modal lain yang masih terbuka
                    const anyModalOpen = document.querySelector('#modal-faktur:not(.hidden), #modal-biaya:not(.hidden), #modal-pelanggan-form:not(.hidden), #modal-konfirmasi-hapus:not(.hidden)');
                    const sidebarOpen = sidebar && !sidebar.classList.contains('-translate-x-full');

                    // Sembunyikan backdrop HANYA jika semua modal tertutup & sidebar mobile tertutup
                    if (!anyModalOpen && !sidebarOpen) {
                        modalBackdrop.classList.add('hidden');
                    }
                }
            }

            // Listener untuk tombol close (X) dan Batal di semua modal
            function addGlobalModalClosers() {
                document.querySelectorAll('[data-close-modal]').forEach(button => {
                    button.addEventListener('click', () => {
                        const modalId = button.dataset.closeModal;
                        const modal = document.getElementById(modalId);
                        if (modal) {
                            closeModal(modal);
                        }
                    });
                });
            }
            
            // (MODIFIKASI) Listener untuk tombol-tombol di Dashboard
            function addDashboardListeners() {
                document.getElementById('dash-buat-faktur')?.addEventListener('click', () => {
                    // Reset form faktur sebelum membuka
                    resetModalFaktur();
                    openModal(modalFaktur);
                });
                document.getElementById('dash-biaya-baru')?.addEventListener('click', () => {
                    resetModalBiaya();
                    openModal(modalBiaya);
                });
                document.getElementById('dash-data-pelanggan')?.addEventListener('click', () => {
                    // Navigasi ke halaman data pelanggan
                    window.location.hash = '#data-pelanggan';
                });
            }

            // --- Fungsi Pencarian & Filter ---
            function setupSearch(inputId, tableBodyId, cellIndex) {
                const searchInput = document.getElementById(inputId);
                const tableBody = document.getElementById(tableBodyId);
                if (!searchInput || !tableBody) return;

                searchInput.addEventListener('keyup', () => {
                    const searchTerm = searchInput.value.toLowerCase();
                    const rows = tableBody.querySelectorAll('tr');

                    rows.forEach(row => {
                        // Cek sel di index 0 (No. Faktur) dan index 1 (Pelanggan)
                        const cell1 = row.cells[0]?.textContent.toLowerCase();
                        const cell2 = row.cells[1]?.textContent.toLowerCase();
                        
                        if (cell1.includes(searchTerm) || cell2.includes(searchTerm)) {
                            row.style.display = '';
                        } else {
                            row.style.display = 'none';
                        }
                    });
                });
            }

            function setupTransactionsTable() {
                const applyBtn = document.getElementById('apply-gl-filter');
                const tableBody = document.getElementById('gl-table-body');
                if (!applyBtn || !tableBody) return;

                applyBtn.addEventListener('click', () => {
                    // Simulasi loading data
                    tableBody.innerHTML = '<tr><td colspan="6" class="py-4 px-4 text-center text-gray-500">Memuat data...</td></tr>';
                    
                    setTimeout(() => {
                        // Simulasi hasil filter
                        tableBody.innerHTML = `
                            <tr class="opacity-0 animate-fadeIn">
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">23 Okt 2024</td>
                                <td class="py-3 px-4 text-sm font-medium">JE-003</td>
                                <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">Biaya Iklan Google Ads</td>
                                <td class="py-3 px-4 text-sm font-medium text-right">Rp 0</td>
                                <td class="py-3 px-4 text-sm font-medium text-right text-red-600 dark:text-red-400">Rp 10.000.000</td>
                                <td class="py-3 px-4 text-sm font-medium text-right">Rp 105.000.000</td>
                            </tr>
                        `;
                        feather.replace();
                    }, 1000);
                });
            }


            // --- FAKTUR PENJUALAN ---
            function setupFakturPenjualanPage() {
                // 1. Render tabel dari database in-memory
                renderTabelFaktur();
                // 2. Setup pencarian
                setupSearch('invoice-search-input', 'invoice-table-body', 0);
                // 3. Setup tombol "Buat Faktur"
                document.getElementById('faktur-buat-faktur')?.addEventListener('click', () => {
                    resetModalFaktur();
                    openModal(modalFaktur);
                });
            }
            
            function renderTabelFaktur() {
                const tableBody = document.getElementById('invoice-table-body');
                if (!tableBody) return;
                tableBody.innerHTML = ''; // Kosongkan tabel
                
                db.fakturPenjualan.forEach(faktur => {
                    let statusClass = '';
                    switch (faktur.status) {
                        case 'Lunas':
                            statusClass = 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200';
                            break;
                        case 'Tertunda':
                            statusClass = 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200';
                            break;
                        case 'Jatuh Tempo':
                            statusClass = 'bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200';
                            break;
                    }

                    const row = `
                        <tr>
                            <td class="py-3 px-4 text-sm font-medium">${faktur.id}</td>
                            <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">${faktur.pelanggan}</td>
                            <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">${faktur.tglTerbit}</td>
                            <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">${faktur.tglJatuhTempo}</td>
                            <td class="py-3 px-4 text-sm font-medium">${formatCurrency(faktur.total)}</td>
                            <td class="py-3 px-4 text-sm">
                                <span class="px-2 py-1 text-xs font-medium rounded-full ${statusClass}">${faktur.status}</span>
                            </td>
                            <td class="py-3 px-4 text-sm">
                                <button data-toast="Fungsi ini belum tersedia." class="btn-toast text-indigo-600 dark:text-indigo-400 hover:underline">Lihat</button>
                            </td>
                        </tr>
                    `;
                    tableBody.innerHTML += row;
                });
            }

            function setupModalFaktur() {
                const form = document.getElementById('modal-faktur-form');
                const dppInput = document.getElementById('faktur-dpp');
                const ppnInput = document.getElementById('faktur-ppn');
                const totalInput = document.getElementById('faktur-total');
                const errorMessage = document.getElementById('faktur-error-message');
                const selectPelanggan = document.getElementById('faktur-pelanggan');
                
                if (!form || !dppInput || !ppnInput || !totalInput || !errorMessage || !selectPelanggan) return;
                
                // (BARU) Isi Pilihan Pelanggan
                selectPelanggan.innerHTML = '<option value="">Pilih Pelanggan</option>'; // Reset
                db.pelanggan.forEach(p => {
                    selectPelanggan.innerHTML += `<option value="${p.nama}">${p.nama}</option>`;
                });

                // Kalkulator Pajak
                dppInput.addEventListener('input', () => {
                    const dpp = parseFloat(dppInput.value) || 0;
                    const ppn = dpp * 0.11;
                    const total = dpp + ppn;
                    ppnInput.value = ppn.toFixed(0);
                    totalInput.value = total.toFixed(0);
                });
                
                // Submit Form
                form.addEventListener('submit', (e) => {
                    e.preventDefault();
                    errorMessage.classList.add('hidden');
                    
                    const pelanggan = document.getElementById('faktur-pelanggan').value;
                    const tanggalInput = document.getElementById('faktur-tanggal').value;
                    const jatuhTempoInput = document.getElementById('faktur-jatuh-tempo').value;
                    const dpp = parseFloat(dppInput.value) || 0;
                    const total = parseFloat(totalInput.value) || 0;
                    
                    // (MODIFIKASI) Validasi
                    if (pelanggan === '' || dpp <= 0) {
                        errorMessage.textContent = 'Harap isi Pelanggan dan DPP (nominal harus > 0).';
                        errorMessage.classList.remove('hidden');
                        return;
                    }
                    
                    // 1. Buat data faktur baru
                    const newInvoice = {
                        id: `INV-2024-00${db.fakturPenjualan.length + 1}`, // ID Sederhana
                        pelanggan: pelanggan,
                        tglTerbit: formatDate(tanggalInput),
                        tglJatuhTempo: formatDate(jatuhTempoInput),
                        total: total,
                        status: 'Tertunda'
                    };
                    
                    // 2. Simpan ke database in-memory
                    db.fakturPenjualan.push(newInvoice);
                    
                    // 3. Tutup modal & tampilkan notifikasi
                    closeModal(modalFaktur);
                    showToast('Faktur penjualan baru berhasil disimpan!');
                    
                    // 4. Render ulang tabel jika kita di halaman faktur
                    if (window.location.hash === '#faktur-penjualan') {
                        renderTabelFaktur();
                    }
                });
            }
            
            function resetModalFaktur() {
                const form = document.getElementById('modal-faktur-form');
                if (form) form.reset(); // Reset semua field
                // Set tanggal hari ini
                const today = new Date().toISOString().split('T')[0];
                const tglTerbit = document.getElementById('faktur-tanggal');
                if (tglTerbit) tglTerbit.value = today;
                
                // Set jatuh tempo (misal: 14 hari)
                const dueDate = new Date();
                dueDate.setDate(dueDate.getDate() + 14);
                const tglJatuhTempo = document.getElementById('faktur-jatuh-tempo');
                if(tglJatuhTempo) tglJatuhTempo.value = dueDate.toISOString().split('T')[0];
                
                document.getElementById('faktur-error-message')?.classList.add('hidden');
            }
            
            
            // --- (BARU) MODAL BIAYA ---
            function setupModalBiaya() {
                const form = document.getElementById('modal-biaya-form');
                const errorMessage = document.getElementById('biaya-error-message');
                if (!form || !errorMessage) return;
                
                form.addEventListener('submit', (e) => {
                    e.preventDefault();
                    errorMessage.classList.add('hidden');
                    
                    const akun = document.getElementById('biaya-akun').value;
                    const nominal = parseFloat(document.getElementById('biaya-nominal').value) || 0;
                    
                    // Validasi
                    if (akun === '' || nominal <= 0) {
                        errorMessage.textContent = 'Harap pilih Akun Biaya dan isi Nominal (harus > 0).';
                        errorMessage.classList.remove('hidden');
                        return;
                    }
                    
                    // Di aplikasi nyata, kita simpan ke DB
                    console.log('Biaya baru:', { akun, nominal });
                    
                    closeModal(modalBiaya);
                    showToast('Biaya baru berhasil dicatat!');
                });
            }
            
            function resetModalBiaya() {
                document.getElementById('modal-biaya-form')?.reset();
                document.getElementById('biaya-error-message')?.classList.add('hidden');
            }


            // --- (BARU) DATA PELANGGAN (CRUD) ---
            function setupDataPelangganPage() {
                // 1. Render tabel
                renderTabelPelanggan();
                // 2. Setup tombol "Pelanggan Baru"
                document.getElementById('btn-pelanggan-baru')?.addEventListener('click', () => {
                    resetModalPelanggan('Pelanggan Baru');
                    openModal(modalPelangganForm);
                });
                // 3. Setup form submit (Create & Update)
                setupFormPelanggan();
                // 4. Setup konfirmasi hapus
                setupKonfirmasiHapus();
            }

            function renderTabelPelanggan() {
                const tableBody = document.getElementById('pelanggan-table-body');
                if (!tableBody) return;
                tableBody.innerHTML = ''; // Kosongkan
                
                db.pelanggan.forEach(p => {
                    const row = document.createElement('tr');
                    row.setAttribute('data-id', p.id); // Simpan ID di baris
                    row.innerHTML = `
                        <td class="py-3 px-4 text-sm font-medium">${p.id}</td>
                        <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">${p.nama}</td>
                        <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">${p.email}</td>
                        <td class="py-3 px-4 text-sm text-gray-600 dark:text-gray-300">${p.telepon}</td>
                        <td class="py-3 px-4 text-sm font-medium ${p.piutang > 0 ? 'text-yellow-600 dark:text-yellow-400' : ''}">${formatCurrency(p.piutang)}</td>
                        <td class="py-3 px-4 text-sm space-x-2">
                            <button class="btn-edit-pelanggan text-indigo-600 dark:text-indigo-400 hover:text-indigo-800 dark:hover:text-indigo-200 p-1">
                                <i data-feather="edit-2" class="w-4 h-4 pointer-events-none"></i>
                            </button>
                            <button class="btn-delete-pelanggan text-red-500 dark:text-red-400 hover:text-red-700 dark:hover:text-red-200 p-1">
                                <i data-feather="trash-2" class="w-4 h-4 pointer-events-none"></i>
                            </button>
                        </td>
                    `;
                    
                    // Tambah listener untuk tombol Edit & Hapus
                    row.querySelector('.btn-edit-pelanggan').addEventListener('click', () => {
                        resetModalPelanggan('Edit Pelanggan', p);
                        openModal(modalPelangganForm);
                    });
                    
                    row.querySelector('.btn-delete-pelanggan').addEventListener('click', () => {
                        openModalHapus('pelanggan', p.id, `pelanggan ${p.nama}`);
                    });
                    
                    tableBody.appendChild(row);
                });
                feather.replace(); // Refresh ikon
            }

            function resetModalPelanggan(title, data = null) {
                const form = document.getElementById('pelanggan-form');
                const titleEl = document.getElementById('modal-pelanggan-title');
                if (!form || !titleEl) return;
                
                form.reset();
                titleEl.textContent = title;
                document.getElementById('pelanggan-error-message').classList.add('hidden');
                
                if (data) {
                    // Mode Edit
                    document.getElementById('pelanggan-id').value = data.id;
                    document.getElementById('pelanggan-nama').value = data.nama;
                    document.getElementById('pelanggan-email').value = data.email;
                    document.getElementById('pelanggan-telepon').value = data.telepon;
                } else {
                    // Mode Create
                    document.getElementById('pelanggan-id').value = '';
                }
            }

            function setupFormPelanggan() {
                const form = document.getElementById('pelanggan-form');
                const errorMessage = document.getElementById('pelanggan-error-message');
                if (!form || !errorMessage) return;
                
                form.addEventListener('submit', (e) => {
                    e.preventDefault();
                    errorMessage.classList.add('hidden');
                    
                    const id = document.getElementById('pelanggan-id').value;
                    const nama = document.getElementById('pelanggan-nama').value;
                    const email = document.getElementById('pelanggan-email').value;
                    const telepon = document.getElementById('pelanggan-telepon').value;
                    
                    if (nama === '' || email === '') {
                        errorMessage.textContent = 'Nama dan Email tidak boleh kosong.';
                        errorMessage.classList.remove('hidden');
                        return;
                    }
                    
                    if (id) {
                        // Mode Edit
                        const index = db.pelanggan.findIndex(p => p.id === id);
                        if (index !== -1) {
                            db.pelanggan[index] = { ...db.pelanggan[index], nama, email, telepon };
                            showToast('Data pelanggan berhasil diperbarui!');
                        }
                    } else {
                        // Mode Create
                        const newId = `CUS-00${db.pelanggan.length + 1}`;
                        db.pelanggan.push({ id: newId, nama, email, telepon, piutang: 0 });
                        showToast('Pelanggan baru berhasil ditambahkan!');
                    }
                    
                    closeModal(modalPelangganForm);
                    renderTabelPelanggan(); // Render ulang tabel
                });
            }

            function openModalHapus(type, id, name) {
                document.getElementById('hapus-item-type').value = type;
                document.getElementById('hapus-item-id').value = id;
                document.getElementById('modal-hapus-message').textContent = `Apakah Anda yakin ingin menghapus data ${name}? Tindakan ini tidak dapat dibatalkan.`;
                document.getElementById('modal-hapus-title').textContent = `Konfirmasi Hapus ${type}`;
                openModal(modalKonfirmasiHapus);
            }
            
            function setupKonfirmasiHapus() {
                const btnHapus = document.getElementById('btn-konfirmasi-hapus');
                if (!btnHapus) return;
                
                btnHapus.addEventListener('click', () => {
                    const id = document.getElementById('hapus-item-id').value;
                    const type = document.getElementById('hapus-item-type').value;
                    
                    if (type === 'pelanggan') {
                        db.pelanggan = db.pelanggan.filter(p => p.id !== id);
                        showToast('Data pelanggan berhasil dihapus!');
                        renderTabelPelanggan(); // Render ulang
                    }
                    // (BARU) Tambahkan logika hapus untuk supplier & coa
                    if (type === 'supplier') {
                        // db.supplier = db.supplier.filter(s => s.id !== id);
                        showToast('Data supplier berhasil dihapus (simulasi)!');
                        // renderTabelSupplier();
                    }
                    if (type === 'coa') {
                        // db.coa = db.coa.filter(c => c.id !== id);
                        showToast('Data akun berhasil dihapus (simulasi)!');
                        // renderTabelCoa();
                    }
                    
                    closeModal(modalKonfirmasiHapus);
                });
            }
            
            
            // --- (BARU) Halaman Master Data Lainnya (Simulasi CRUD) ---
            
            function setupDataSupplierPage() {
                document.getElementById('btn-supplier-baru')?.addEventListener('click', () => {
                    resetModalPelanggan('Supplier Baru'); // Pakai modal pelanggan
                    openModal(modalPelangganForm);
                });
                document.querySelectorAll('.btn-edit-supplier').forEach(btn => {
                    btn.addEventListener('click', () => {
                        // Simulasi: isi data dummy
                        const data = { id: 'SUP-001', nama: 'PT Office Sukses', email: 'sales@office.com', telepon: '021-111-222' };
                        resetModalPelanggan('Edit Supplier', data); // Pakai modal pelanggan
                        openModal(modalPelangganForm);
                    });
                });
                document.querySelectorAll('.btn-delete-supplier').forEach(btn => {
                    btn.addEventListener('click', () => {
                        openModalHapus('supplier', 'SUP-001', 'supplier PT Office Sukses');
                    });
                });
            }
            
            function setupDataCoaPage() {
                document.getElementById('btn-coa-baru')?.addEventListener('click', () => {
                    resetModalPelanggan('Akun Baru'); // Pakai modal pelanggan
                    openModal(modalPelangganForm);
                });
                document.querySelectorAll('.btn-edit-coa').forEach(btn => {
                    btn.addEventListener('click', () => {
                        // Simulasi: isi data dummy
                        const data = { id: '10100', nama: 'Kas & Setara Kas', email: 'kas@akun.com', telepon: '' };
                        resetModalPelanggan('Edit Akun', data); // Pakai modal pelanggan
                        openModal(modalPelangganForm);
                    });
                });
                document.querySelectorAll('.btn-delete-coa').forEach(btn => {
                    btn.addEventListener('click', () => {
                        openModalHapus('coa', '10100', 'akun Kas & Setara Kas');
                    });
                });
            }
            
            // --- (BARU) Halaman Operasional Lainnya (Simulasi Tombol) ---
            
            function setupPesananPenjualanPage() {
                document.getElementById('btn-buat-so')?.addEventListener('click', () => {
                    resetModalFaktur(); // Buka modal faktur
                    openModal(modalFaktur);
                });
            }
            
            function setupPesananPembelianPage() {
                document.getElementById('btn-buat-po')?.addEventListener('click', () => {
                    resetModalBiaya(); // Buka modal biaya
                    openModal(modalBiaya);
                });
            }
            
            function setupFakturPembelianPage() {
                document.getElementById('btn-catat-faktur-beli')?.addEventListener('click', () => {
                    resetModalBiaya(); // Buka modal biaya
                    openModal(modalBiaya);
                });
            }


            // --- Logika Navigasi Hash ---
            function handleNavigation() {
                let pageId = window.location.hash.substring(1);
                // (MODIFIKASI) Ganti 'faktur' ke 'faktur-penjualan'
                if (pageId === 'faktur') pageId = 'faktur-penjualan';
                if (!pageId) pageId = 'dashboard';

                navigateTo(pageId);

                // Tutup sidebar jika di mobile
                if (sidebar) {
                    sidebar.classList.add('-translate-x-full');
                    modalBackdrop.classList.add('hidden');
                }
            }

            // --- Inisialisasi Aplikasi ---
            addGlobalModalClosers();
            setupModalFaktur(); // (BARU)
            setupModalBiaya(); // (BARU)
            
            // (BARU) Listener untuk tombol logout
            document.getElementById('btn-logout')?.addEventListener('click', (e) => {
                e.preventDefault();
                showToast('Anda telah keluar (simulasi).', true);
                profileDropdown.classList.add('hidden');
            });
            
            // (BARU) Listener untuk header search
            if (headerSearchInput && searchResultsDropdown && searchResultsList) {
                // Tampilkan saat diklik/focus
                headerSearchInput.addEventListener('focus', () => {
                    if (headerSearchInput.value.length > 0) {
                        searchResultsDropdown.classList.remove('hidden');
                    }
                });

                // Sembunyikan saat klik di luar (blur)
                headerSearchInput.addEventListener('blur', () => {
                    setTimeout(() => {
                        searchResultsDropdown.classList.add('hidden');
                    }, 150);
                });
                
                // Filter saat mengetik
                headerSearchInput.addEventListener('input', () => { // 'input' lebih baik dari 'keyup'
                    const searchTerm = headerSearchInput.value.toLowerCase();
                    if (searchTerm.length === 0) {
                        searchResultsList.innerHTML = '<li class="p-3 text-sm text-gray-500 dark:text-gray-400 text-center">Mulai mengetik untuk mencari...</li>';
                        searchResultsDropdown.classList.add('hidden');
                        return;
                    }
                    
                    const results = dummySearchData.filter(item => item.title.toLowerCase().includes(searchTerm));
                    searchResultsList.innerHTML = ''; // Kosongkan hasil
                    
                    if (results.length > 0) {
                        results.forEach(item => {
                            // (FIX) Tambahkan class sidebar-link agar navigasi hash berfungsi
                            searchResultsList.innerHTML += `
                                <li class="border-b border-gray-100 dark:border-gray-600">
                                    <a href="${item.href}" class="sidebar-link block p-3 text-sm hover:bg-gray-50 dark:hover:bg-gray-600">${item.title}</a>
                                </li>
                            `;
                        });
                        // (FIX) Tambahkan listener ke link hasil pencarian yang baru dibuat
                        searchResultsList.querySelectorAll('.sidebar-link').forEach(link => {
                            link.addEventListener('click', handleNavigation);
                        });
                    } else {
                        searchResultsList.innerHTML = '<li class="p-3 text-sm text-gray-500 dark:text-gray-400 text-center">Tidak ada hasil ditemukan.</li>';
                    }
                    searchResultsDropdown.classList.remove('hidden');
                });
            }

            // Navigasi saat memuat halaman
            handleNavigation();
            // Navigasi saat hash berubah
            window.addEventListener('hashchange', handleNavigation);
            // Navigasi saat mengklik link sidebar
            document.querySelectorAll('.sidebar-link').forEach(link => {
                link.addEventListener('click', (e) => {
                    // Hanya tangani jika itu link hash
                    const href = link.getAttribute('href');
                    if (href && href.startsWith('#')) {
                        // e.preventDefault(); // Tidak perlu, biarkan hash berubah
                        window.location.hash = href;
                    }
                });
            });

        }); // Akhir DOMContentLoaded
    </script>
</body>

</html>